<!doctype html><html class="theme-next mist use-motion"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css" rel="stylesheet" type="text/css"><link href="//fonts.useso.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css"><meta name="keywords" content="软件设计模式 cpp,"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2"><meta name="description" content="模版方法模式（Template Method）、命令模式（Command）、观察者模式（Observer）、备忘录模式（Memento）、策略模式（Strategy）"><meta property="og:type" content="article"><meta property="og:title" content="行为型模式(1)"><meta property="og:url" content="https://sambeauwang.github.io/2017/03/22/行为型模式-1/index.html"><meta property="og:site_name" content="Sambeau"><meta property="og:description" content="模版方法模式（Template Method）、命令模式（Command）、观察者模式（Observer）、备忘录模式（Memento）、策略模式（Strategy）"><meta property="og:image" content="https://sambeauwang.github.io/pic/策略模式.gif"><meta property="og:image" content="https://sambeauwang.github.io/pic/观察者模式.jpg"><meta property="og:image" content="https://sambeauwang.github.io/pic/命令模式.png"><meta property="og:image" content="https://sambeauwang.github.io/pic/模板方法模式.png"><meta property="og:image" content="https://sambeauwang.github.io/pic/备忘录模式.jpg"><meta property="og:updated_time" content="2017-03-31T15:21:32.429Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="行为型模式(1)"><meta name="twitter:description" content="模版方法模式（Template Method）、命令模式（Command）、观察者模式（Observer）、备忘录模式（Memento）、策略模式（Strategy）"><meta name="twitter:image" content="https://sambeauwang.github.io/pic/策略模式.gif"><script type="text/javascript" id="hexo.configuration">var NexT=window.NexT||{},CONFIG={scheme:"Mist",sidebar:{position:"left",display:"hide"},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"博主"}}</script><link rel="canonical" href="https://sambeauwang.github.io/2017/03/22/行为型模式-1/"><title>行为型模式(1) | Sambeau</title></head><body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans"><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-86063343-1","auto"),ga("send","pageview")</script><div class="container one-collumn sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="//schema.org/WPHeader"><div class="header-inner"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Sambeau</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section">首页</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section">分类</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section">归档</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section">标签</a></li><li class="menu-item menu-item-schedule"><a href="/schedule" rel="section">日程</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="st-search-show-outputs">搜索</a></li></ul><div class="site-search"><form class="site-search-form"><input type="text" id="st-search-input" class="st-search-input st-default-search-input"></form><script type="text/javascript">!function(t,e,n,s,c,a,i){t.SwiftypeObject=c,t[c]=t[c]||function(){(t[c].q=t[c].q||[]).push(arguments)},a=e.createElement(n),i=e.getElementsByTagName(n)[0],a.async=1,a.src=s,i.parentNode.insertBefore(a,i)}(window,document,"script","//s.swiftypecdn.com/install/v2/st.js","_st"),_st("install","YjoQj_U5CFYfraaUGKBM","2.0.0")</script></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="//schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline">行为型模式(1)</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2017-03-22T21:59:03+08:00" content="2017-03-22">2017-03-22 </time></span><span class="post-category">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/软件设计模式-cpp/" itemprop="url" rel="index"><span itemprop="name">软件设计模式 cpp</span> </a></span></span><span class="post-comments-count">&nbsp; | &nbsp; <a href="/2017/03/22/行为型模式-1/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/03/22/行为型模式-1/" itemprop="commentsCount"></span> </a></span><span id="/2017/03/22/行为型模式-1/" class="leancloud_visitors" data-flag-title="行为型模式(1)">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数 </span><span class="leancloud-visitors-count"></span></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="行为型模式"><a href="#行为型模式" class="headerlink" title="行为型模式"></a>行为型模式</h3><p>包括：模版方法模式（Template Method）、命令模式（Command）、观察者模式（Observer）、备忘录模式（Memento）、策略模式（Strategy）</p><h3 id="策略模式（Strategy-Pattern）"><a href="#策略模式（Strategy-Pattern）" class="headerlink" title="策略模式（Strategy Pattern）"></a>策略模式（Strategy Pattern）</h3><p>策略模式定义了一系列算法，并将每个算法封装起来，使他们可以相互替换，且算法的变化不会影响到使用算法的客户。需要设计一个接口，为一系列实现类提供统一的方法，多个实现类实现该接口，设计一个抽象类，提供辅助函数.</p><ul><li>封装变化: 找出应用中可能需要变化之处，把它们独立出来，不要和那些不需要变化的代码混在一起</li><li>针对接口编程，而不是针对实现编程。这里要说明一下，C++的接口指的是抽象类，含有纯虚函数的类</li><li>使用了我们的第三个设计原则：多用组合，少用继承。</li></ul><p><img src="/pic/策略模式.gif" alt="策略模式"><br></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 设计一款模拟鸭子的游戏：游戏中会出现各种鸭子，一遍游泳戏水，一边呱呱叫。</span></div><div class="line"><span class="comment">//飞行接口，所有飞行类都实现它，所有新的飞行类都必须实现fly()方法</span></div><div class="line"><span class="keyword">class</span> FlyBehavior&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>=<span class="number">0</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//翅膀飞行类</span></div><div class="line"><span class="keyword">class</span> FlyWithWings:<span class="keyword">public</span> FlyBehavior&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="comment">//实现鸭子飞行</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//不飞行类</span></div><div class="line"><span class="keyword">class</span> FlyNoWay:<span class="keyword">public</span> FlyBehavior&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="comment">//什么都不做，鸭子不飞行</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//呱呱叫行为接口，一个接口只包含一个需要实现的quack()方法</span></div><div class="line"><span class="keyword">class</span> QuackBehavior&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>=<span class="number">0</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//真的呱呱叫</span></div><div class="line"><span class="keyword">class</span> Quack:<span class="keyword">public</span> QuackBehavior&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>&#123;<span class="comment">//实现鸭子呱呱叫&#125;</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//吱吱叫</span></div><div class="line"><span class="keyword">class</span> Squeak:<span class="keyword">public</span> QuackBehavior&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>&#123;<span class="comment">//实现鸭子吱吱叫&#125;</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//不叫</span></div><div class="line"><span class="keyword">class</span> MuteQuack:<span class="keyword">public</span> QuackBehavior&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>&#123;<span class="comment">//什么都不做，不会叫&#125;</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//橡胶鸭类</span></div><div class="line"><span class="keyword">class</span> RubberDuck &#123;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    FlyBehavior* flyBehavior;</div><div class="line">    QuackBehavior* quackBehavior;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    RubberDuck() &#123;</div><div class="line">        flyBehavior = <span class="keyword">new</span> FlyNoWay();</div><div class="line">        quackBehavior = <span class="keyword">new</span> Squeak();</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//飞行行为</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">performFly</span><span class="params">()</span> </span>&#123;</div><div class="line">        flyBehavior-&gt;fly();</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//改变飞行行为</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setFlyBehavior</span><span class="params">(FlyBehavior* flyB)</span> </span>&#123;</div><div class="line">        flyBehavior = flyB;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//呱呱叫行为</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">performQuack</span><span class="params">()</span> </span>&#123;</div><div class="line">        quackBehavior-&gt;quack();</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//改变叫声</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setPerformQuack</span><span class="params">(QuackBehavior* quackB)</span> </span>&#123;</div><div class="line">        quackBehavior = quackB;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//其他行为方法及析构函数</span></div><div class="line">    ...</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p></p><h3 id="观察者模式（Observer-Pattern）"><a href="#观察者模式（Observer-Pattern）" class="headerlink" title="观察者模式（Observer Pattern）"></a>观察者模式（Observer Pattern）</h3><p>观察者模式（Observer Pattern）属于行为型模式，在对象之间定义一对多的依赖，这样一来，当一个对象改变状态，依赖它的对象都会收到通知，并自动更新。<br><img src="/pic/观察者模式.jpg" alt="观察者模式"></p><ul><li>Subject：抽象主题（抽象被观察者），抽象主题对象把所有观察者对象保存在一个集合里，每个主题都可以有任意数量的观察者。抽象主题提供一个接口，可以增加和删除观察者对象。</li><li>ConcreteSubject：具体主题（具体被观察者），将有关状态存入具体观察者对象，在具体主题内部状态发生改变时，给所有注册的观察者发送通知。</li><li>Observer：抽象观察者，是观察者的抽象类，它定义了一个更新接口，使得在得到主题更改通知时更新自己。</li><li>ConcrereObserver：具体观察者，是实现抽象观察者定义的更新接口，以便在得到主题更改通知时更新自身的状态。</li></ul><p>假设现在需要完成公司的一个项目，气象站项目。气象站的数据由WeatherData对象提供，包括温度、湿度和气压。项目要求有两种布告板，分别显示目前状况(CurrentStatus)和气象统计(Statistics)。当WeatherData对象获得最新的测量数据时，两种布告板必须实时更新。而且，这是一个可以扩展的气象站，需要公布一组API，好让其他开发人员可以写出自己的布告板。<br></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 抽象观察者（Observer）。里面定义了一个更新的方法：</span></div><div class="line"><span class="keyword">class</span> Observer &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">float</span> temperature,<span class="keyword">float</span> humidity,<span class="keyword">float</span> pressure)</span></span>=<span class="number">0</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 具体观察者（Concrete Observer）。布告板是观察者，里面实现了更新的方法：</span></div><div class="line"><span class="comment">//目前状况布告板：CurrentStatus</span></div><div class="line"><span class="keyword">class</span> CurrentStatus:<span class="keyword">public</span> Observer&#123;</div><div class="line">    ...</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="comment">//具体实现更新接口函数</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">float</span> temperature,<span class="keyword">float</span> humidity,<span class="keyword">float</span> pressure)</span></span>&#123;</div><div class="line">         <span class="comment">//同上</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//显示当前气象信息</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>&#123;...&#125; <span class="comment">//同上</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//气象信息统计布告板：Statistics</span></div><div class="line"><span class="keyword">class</span> Statistics:<span class="keyword">public</span> Observer&#123;</div><div class="line">    ...</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="comment">//具体实现更新接口函数</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">float</span> temperature,<span class="keyword">float</span> humidity,<span class="keyword">float</span> pressure&#123;</span></span></div><div class="line">         <span class="comment">//同上</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//显示气象统计信息</span></div><div class="line">    <span class="keyword">void</span> display()&#123;...&#125; <span class="comment">//同上</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 抽象被观察者（Subject）。抽象主题提供了注册attach、移除detach和通知notify三个纯虚函数，供具体被观察者实现：</span></div><div class="line"><span class="keyword">class</span> Subject&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">   <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Observer*)</span></span>=<span class="number">0</span>;</div><div class="line">   <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">detach</span><span class="params">(Observer*)</span></span>=<span class="number">0</span>;</div><div class="line">   <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">()</span></span>=<span class="number">0</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 具体被观察者（Concrete Subject）。这里的WeatherData类是具体主题（具体被观察者），具体实现如下：</span></div><div class="line"><span class="keyword">class</span> WeatherData:<span class="keyword">public</span> Subject&#123;</div><div class="line">    <span class="keyword">float</span> temperature=<span class="number">0</span>;</div><div class="line">    <span class="keyword">float</span> humidity=<span class="number">0</span>;</div><div class="line">    <span class="keyword">float</span> pressure=<span class="number">0</span>;</div><div class="line">    <span class="built_in">list</span>&lt;Observer*&gt; <span class="built_in">list</span>; <span class="comment">//用于记录注册的观察者</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="comment">//实现注册</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">attach</span><span class="params">(Observer* o)</span></span>&#123;</div><div class="line">        <span class="built_in">list</span>.push_back(o);</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//实现移除</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">detach</span><span class="params">(Observer* o)</span></span>&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> it=<span class="built_in">list</span>.begin();it!=<span class="built_in">list</span>.end();++it)&#123;</div><div class="line">            <span class="keyword">if</span>(*it==o)&#123;</div><div class="line">                <span class="built_in">list</span>.erase(it);</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//实现通知所有的观察者</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">notify</span><span class="params">()</span></span>&#123;</div><div class="line">         <span class="keyword">for</span>(<span class="keyword">auto</span> it=<span class="built_in">list</span>.begin();it!=<span class="built_in">list</span>.end();++it)&#123;</div><div class="line">                (*it)-&gt;update(temperature,humidity,pressure);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    <span class="comment">//设置观测值</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setMeasurements</span><span class="params">(<span class="keyword">float</span> temperature,<span class="keyword">float</span> humidity,<span class="keyword">float</span> pressure)</span></span>&#123;</div><div class="line">        <span class="keyword">this</span>-&gt;temperature= temperature;</div><div class="line">        <span class="keyword">this</span>-&gt;humidity= humidity;</div><div class="line">        <span class="keyword">this</span>-&gt;pressure= pressure;</div><div class="line">        <span class="keyword">this</span>-&gt;notify();<span class="comment">//观测值更新，通知观察者</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//WeatherData的其他方法</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure><p></p><p><strong>使用场景：</strong></p><ul><li>（1）关联行为场景。需要注意的是，关联行为是可拆分的，而不是“组合”关系。</li><li>（2）事件多级触发场景。跨系统的消息交换场景，如消息队列、事件总线的处理机制。</li></ul><h3 id="命令模式（Command-Pattern）"><a href="#命令模式（Command-Pattern）" class="headerlink" title="命令模式（Command Pattern）"></a>命令模式（Command Pattern）</h3><p>命令模式（Command Pattern）属行为型，将请求封装成对象，以便使用不同的请求、请求日志或请求队列等来参数化其他对象。命令模式也支持撤销操作。通过增加一个命令对象，放在请求者与请求的接收者之间，来达到二者的解耦合。一个请求对应一个命令对象，命令对象将请求的接收者和完成请求的基本操作封装在一起，对外提供execute()方法。完成请求的基本操作由接收者提供，在execute()方法中被调来完成请求，请求者如果调用execute()，请求的目的就能达到，而不需要直接与请求的接收者交互，降低了耦合度。</p><p><img src="/pic/命令模式.png" alt="命令模式"></p><ul><li>Client类：最终的客户端调用类。</li><li>Invoker类：调用者，调用具体命令类提供的execute()方法来完成请求。</li><li>Command类：是一个抽象类，一般需要对外公布一个execute()方法来完成请求。</li><li>ConcreteCommand类：Command类的实现类，对抽象类中声明的execute()方法进行实现。</li><li>Receiver类：接收者，动作的执行者，对外提供基本操作，交由ConcreteCommand类调用，来完成Invoker类的请求。</li></ul><p>去餐厅吃饭的流程一般是这样的，服务员叫消费者点餐，下单生成订单，订单送往厨房交由厨师烹饪。四个角色，消费者对应Client类，服务员对应Invoker类，订单对应ConcreteCommand类，厨师对应Receiver类。服务员通过订单，无需自己完成食物的烹饪，而是交由厨师来完成，所以服务员是烹饪食物该动作的请求者，订单充当命令的角色，厨师是完成食物烹饪的动作执行者。<br></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 动作执行者厨师类：</span></div><div class="line"><span class="keyword">class</span> Chef &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cook</span><span class="params">()</span> <span class="keyword">const</span></span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"开始烹饪"</span>&lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 充当命令角色的订单类：</span></div><div class="line"><span class="comment">//抽象命令类</span></div><div class="line"><span class="keyword">class</span> Command&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> <span class="keyword">const</span> </span>= <span class="number">0</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//订单类</span></div><div class="line"><span class="keyword">class</span> OrderCommand:<span class="keyword">public</span> Command&#123;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keyword">const</span> Chef &amp;chef;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    OrderCommand(<span class="keyword">const</span> Chef &amp; chef):chef(chef)&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> <span class="keyword">const</span></span>&#123;</div><div class="line">        chef.cook();</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 烹饪动作请求者服务员类：</span></div><div class="line"><span class="keyword">class</span> Attendant &#123;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keyword">const</span> OrderCommand &amp; orderCommand;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Attendant(<span class="keyword">const</span> OrderCommand &amp; orderCommand):orderCommand(orderCommand)&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cook</span><span class="params">()</span> </span>&#123;</div><div class="line">        orderCommand.execute();</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p></p><p><strong>应用场景：</strong><br>对于大多数请求-响应模式的功能，比较适合使用命令模式，正如命令模式定义说的那样，命令模式对实现记录日志、撤销操作等功能比较方便。</p><h3 id="模板方法模式（Template-Method-Pattern）"><a href="#模板方法模式（Template-Method-Pattern）" class="headerlink" title="模板方法模式（Template Method Pattern）"></a>模板方法模式（Template Method Pattern）</h3><p>模板方法模式（Template Method Pattern）属行为型，在一个方法中定义一个算法骨架，而将一些步骤延迟到子类中，使子类可以不改变算法结构即可重定义算法的某些特定步骤。</p><p><img src="/pic/模板方法模式.png" alt="模板方法模式"></p><ul><li>AbstractClass：实现了模板方法，定义了算法骨架。</li><li>ConcreteClass：实现抽象类中的抽象方法，完成完整的算法。</li></ul><p>一个武侠要战斗的时候，也有一套固定的模式，那就是运行内功、开通经脉、准备武器和使用招式。<br></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">// 这个抽象类包含了三种类型的方法，分别是抽象方法、具体方法和钩子方法。</span></div><div class="line"><span class="comment">// 抽象方法是交由子类去实现，具体方法则在父类实现了子类公共的方法实现，在上面的例子就是武侠开通经脉的方式都一样，所以就在具体方法中实现。钩子方法则分为两类，第一类是hook()，它有一个空实现的方法，子类可以视情况来决定是否要覆盖它；第二类则是hasWeapons()，这类钩子方法的返回类型通常是bool类型的，一般用于对某个条件进行判断，如果条件满足则执行某一步骤，否则将不执行。</span></div><div class="line"><span class="keyword">class</span> AbstractSwordsman &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fighting</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="comment">//运行内功，抽象方法</span></div><div class="line">        neigong();</div><div class="line">        <span class="comment">//调整经脉,具体方法</span></div><div class="line">        meridian();</div><div class="line">        <span class="comment">//如果有武器则准备武器</span></div><div class="line">        <span class="keyword">if</span> (hasWeapons()) &#123;</div><div class="line">            weapons();</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//使用招式</span></div><div class="line">        moves();</div><div class="line">        <span class="comment">//钩子方法</span></div><div class="line">        hook();<span class="comment">//用于判断是否在算法骨架中是否执行某一算法</span></div><div class="line">    &#125;</div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">neigong</span><span class="params">()</span> </span>= <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">weapons</span><span class="params">()</span> </span>= <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">moves</span><span class="params">()</span> </span>= <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">meridian</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"开通正经与奇经"</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//是否有武器，默认是有武器的，钩子方法</span></div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">bool</span> <span class="title">hasWeapons</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//钩子方法实现为空</span></div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">hook</span><span class="params">()</span></span>&#123;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// concrete</span></div><div class="line"><span class="keyword">class</span> ZhangWuJi:<span class="keyword">public</span> AbstractSwordsman &#123;</div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="comment">// @ Override</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">neigong</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"运行九阳神功"</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// @ Override</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">weapons</span><span class="params">()</span></span>&#123;&#125; <span class="comment">//实现为空</span></div><div class="line"></div><div class="line">    <span class="comment">// @ Override</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">moves</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"使用招式乾坤大挪移"</span>&lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// @ Override</span></div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">hasWeapons</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p></p><p><strong>应用场景：</strong></p><ul><li>（1）各子类中公共的行为应被提取出来并集中到一个公共父类中以避免代码重复。</li><li>（2）面对重要复杂的算法，可以把核心算法设计为模版方法，周边相关细节功能交由各个子类实现。</li><li>（3）需要通过子类来决定父类算法中某个步骤是否执行，实现子类对父类的反向控制。</li></ul><h3 id="备忘录模式"><a href="#备忘录模式" class="headerlink" title="备忘录模式"></a>备忘录模式</h3><p>在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。这样就可以将该对象恢复到原先保存的状态<br><img src="/pic/备忘录模式.jpg" alt="备忘录模式"></p><ul><li>发起人：记录当前时刻的内部状态，负责定义哪些属于备份范围的状态，负责创建和恢复备忘录数据。</li><li>备忘录：负责存储发起人对象的内部状态，在需要的时候提供发起人需要的内部状态。</li><li>管理角色：对备忘录进行管理，保存和提供备忘录。</li></ul><p>Memento类定义了内部的状态，而Caretake类是一个保存进度的管理者，GameRole类是游戏角色类。可以看到GameRole的对象依赖于Memento对象，而与Caretake对象无关。<br></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//需保存的信息</span></div><div class="line"><span class="keyword">class</span> Memento</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">int</span> m_vitality; <span class="comment">//生命值</span></div><div class="line">    <span class="keyword">int</span> m_attack;   <span class="comment">//进攻值</span></div><div class="line">    <span class="keyword">int</span> m_defense;  <span class="comment">//防守值</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Memento(<span class="keyword">int</span> vitality, <span class="keyword">int</span> attack, <span class="keyword">int</span> defense):</div><div class="line">      m_vitality(vitality),m_attack(attack),m_defense(defense)&#123;&#125;</div><div class="line">    Memento &amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Memento &amp;memento)</div><div class="line">    &#123;</div><div class="line">        m_vitality = memento.m_vitality;</div><div class="line">        m_attack = memento.m_attack;</div><div class="line">        m_defense = memento.m_defense;</div><div class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//游戏角色</span></div><div class="line"><span class="keyword">class</span> GameRole</div><div class="line">&#123;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="keyword">int</span> m_vitality;</div><div class="line">    <span class="keyword">int</span> m_attack;</div><div class="line">    <span class="keyword">int</span> m_defense;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    GameRole(): m_vitality(<span class="number">100</span>),m_attack(<span class="number">100</span>),m_defense(<span class="number">100</span>) &#123;&#125;</div><div class="line">    <span class="function">Memento <span class="title">Save</span><span class="params">()</span>  <span class="comment">//保存进度，只与Memento对象交互，并不牵涉到Caretake</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="function">Memento <span class="title">memento</span><span class="params">(m_vitality, m_attack, m_defense)</span></span>;</div><div class="line">        <span class="keyword">return</span> memento;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Load</span><span class="params">(Memento memento)</span>  <span class="comment">//载入进度，只与Memento对象交互，并不牵涉到Caretake</span></span></div><div class="line">    &#123;</div><div class="line">        m_vitality = memento.m_vitality;</div><div class="line">        m_attack = memento.m_attack;</div><div class="line">        m_defense = memento.m_defense;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> </span>&#123; <span class="built_in">cout</span>&lt;&lt;<span class="string">"vitality : "</span>&lt;&lt; m_vitality&lt;&lt;<span class="string">", attack : "</span>&lt;&lt; m_attack&lt;&lt;<span class="string">", defense : "</span>&lt;&lt; m_defense&lt;&lt; <span class="built_in">endl</span>; &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Attack</span><span class="params">()</span> </span>&#123; m_vitality -= <span class="number">10</span>; m_attack -= <span class="number">10</span>;  m_defense -= <span class="number">10</span>; &#125;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//保存的进度库</span></div><div class="line"><span class="keyword">class</span> Caretake</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Caretake() &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Save</span><span class="params">(Memento menento)</span> </span>&#123; m_vecMemento.push_back(menento); &#125;</div><div class="line">    <span class="function">Memento <span class="title">Load</span><span class="params">(<span class="keyword">int</span> state)</span> </span>&#123; <span class="keyword">return</span> m_vecMemento[state]; &#125;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="built_in">vector</span>&lt;Memento&gt; m_vecMemento;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 客户使用方式：</span></div><div class="line"><span class="comment">//测试案例</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    Caretake caretake;</div><div class="line">    GameRole role;</div><div class="line">    role.Show();   <span class="comment">//初始值</span></div><div class="line">    caretake.Save(role.Save()); <span class="comment">//保存状态</span></div><div class="line">    role.Attack();</div><div class="line">    role.Show();  <span class="comment">//进攻后</span></div><div class="line">    role.Load(caretake.Load(<span class="number">0</span>)); <span class="comment">//载入状态</span></div><div class="line">    role.Show();  <span class="comment">//恢复到状态0</span></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p></div><div></div><div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/软件设计模式-cpp/" rel="tag">#软件设计模式 cpp</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2017/03/22/软件设计模式/" rel="next" title="软件设计模式"><i class="fa fa-chevron-left"></i> 软件设计模式</a></div><div class="post-nav-prev post-nav-item"><a href="/2017/03/22/行为型模式-2/" rel="prev" title="行为型模式(2)">行为型模式(2) <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Sambeau Wang"><p class="site-author-name" itemprop="name">Sambeau Wang</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">24</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags"><span class="site-state-item-count">5</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/SambeauWang" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub </a></span><span class="links-of-author-item"><a href="sambeauwang@gmail.com" target="_blank" title="Gmail"><i class="fa fa-fw fa-gmail"></i> Gmail</a></span></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#行为型模式"><span class="nav-number">1.</span> <span class="nav-text">行为型模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#策略模式（Strategy-Pattern）"><span class="nav-number">2.</span> <span class="nav-text">策略模式（Strategy Pattern）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#观察者模式（Observer-Pattern）"><span class="nav-number">3.</span> <span class="nav-text">观察者模式（Observer Pattern）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#命令模式（Command-Pattern）"><span class="nav-number">4.</span> <span class="nav-text">命令模式（Command Pattern）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#模板方法模式（Template-Method-Pattern）"><span class="nav-number">5.</span> <span class="nav-text">模板方法模式（Template Method Pattern）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#备忘录模式"><span class="nav-number">6.</span> <span class="nav-text">备忘录模式</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2017</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Sambeau Wang</span></div><div class="powered-by"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>本站总访问量 <span id="busuanzi_value_site_pv"></span> &nbsp&nbsp&nbsp 您是第<span id="busuanzi_value_site_uv"></span>个来到的小伙伴</div><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script><script type="text/javascript">function run_disqus_script(s){var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src="//"+disqus_shortname+".disqus.com/"+s,(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(i)}var disqus_shortname="sambeaublog.disqus.com/admin",disqus_identifier="2017/03/22/行为型模式-1/",disqus_title="行为型模式(1)",disqus_url="https://sambeauwang.github.io/2017/03/22/行为型模式-1/";run_disqus_script("count.js");var disqus_config=function(){this.page.url=disqus_url,this.page.identifier=disqus_identifier,this.page.title=disqus_title};run_disqus_script("embed.js")</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("MmTla9uHtyvAotAPz2aHArnn-gzGzoHsz","ppTjU9IN1rosOHlnsYjpxXJe")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){var t=".leancloud-visitors-count";if(0===e.length)return void o.find(t).text(0);for(var i=0;i<e.length;i++){var r=e[i],s=r.get("url"),l=r.get("time"),c=document.getElementById(s);$(c).find(t).text(l)}for(var i=0;i<n.length;i++){var s=n[i],c=document.getElementById(s),u=$(c).find(t);""==u.text()&&u.text(0)}}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var r=new e,s=new AV.ACL;s.setPublicReadAccess(!0),s.setPublicWriteAccess(!0),r.setACL(s),r.set("title",o),r.set("url",n),r.set("time",1),r.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script></body></html>