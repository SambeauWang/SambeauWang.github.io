<!doctype html><html class="theme-next mist use-motion"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css" rel="stylesheet" type="text/css"><link href="//fonts.useso.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css"><meta name="keywords" content="软件设计模式 cpp,"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2"><meta name="description" content="适配器模式（Adapter）、桥接模式（Bridge）、装饰模式（Decorator）、组合模式（Composite）、外观模式（Facade）、享元模式（Flyweight）、代理模式（Proxy）"><meta property="og:type" content="article"><meta property="og:title" content="结构型模式"><meta property="og:url" content="https://sambeauwang.github.io/2017/03/22/结构型模式/index.html"><meta property="og:site_name" content="Sambeau"><meta property="og:description" content="适配器模式（Adapter）、桥接模式（Bridge）、装饰模式（Decorator）、组合模式（Composite）、外观模式（Facade）、享元模式（Flyweight）、代理模式（Proxy）"><meta property="og:image" content="https://sambeauwang.github.io/pic/装饰者模式.png"><meta property="og:image" content="https://sambeauwang.github.io/pic/装饰者模式.png"><meta property="og:image" content="https://sambeauwang.github.io/pic/适配器模式.png"><meta property="og:image" content="https://sambeauwang.github.io/pic/类适配器.png"><meta property="og:image" content="https://sambeauwang.github.io/pic/组合模式.gif"><meta property="og:image" content="https://sambeauwang.github.io/pic/代理模式.gif"><meta property="og:image" content="https://sambeauwang.github.io/pic/享元模式.jpg"><meta property="og:image" content="https://sambeauwang.github.io/pic/桥接模式.gif"><meta property="og:updated_time" content="2017-03-22T14:18:18.209Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="结构型模式"><meta name="twitter:description" content="适配器模式（Adapter）、桥接模式（Bridge）、装饰模式（Decorator）、组合模式（Composite）、外观模式（Facade）、享元模式（Flyweight）、代理模式（Proxy）"><meta name="twitter:image" content="https://sambeauwang.github.io/pic/装饰者模式.png"><script type="text/javascript" id="hexo.configuration">var NexT=window.NexT||{},CONFIG={scheme:"Mist",sidebar:{position:"left",display:"hide"},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"博主"}}</script><link rel="canonical" href="https://sambeauwang.github.io/2017/03/22/结构型模式/"><title>结构型模式 | Sambeau</title></head><body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans"><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-86063343-1","auto"),ga("send","pageview")</script><div class="container one-collumn sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="//schema.org/WPHeader"><div class="header-inner"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Sambeau</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section">首页</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section">分类</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section">归档</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section">标签</a></li><li class="menu-item menu-item-schedule"><a href="/schedule" rel="section">日程</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="st-search-show-outputs">搜索</a></li></ul><div class="site-search"><form class="site-search-form"><input type="text" id="st-search-input" class="st-search-input st-default-search-input"></form><script type="text/javascript">!function(t,e,n,s,c,a,i){t.SwiftypeObject=c,t[c]=t[c]||function(){(t[c].q=t[c].q||[]).push(arguments)},a=e.createElement(n),i=e.getElementsByTagName(n)[0],a.async=1,a.src=s,i.parentNode.insertBefore(a,i)}(window,document,"script","//s.swiftypecdn.com/install/v2/st.js","_st"),_st("install","YjoQj_U5CFYfraaUGKBM","2.0.0")</script></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="//schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline">结构型模式</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2017-03-22T22:02:01+08:00" content="2017-03-22">2017-03-22 </time></span><span class="post-category">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/软件设计模式-cpp/" itemprop="url" rel="index"><span itemprop="name">软件设计模式 cpp</span> </a></span></span><span class="post-comments-count">&nbsp; | &nbsp; <a href="/2017/03/22/结构型模式/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/03/22/结构型模式/" itemprop="commentsCount"></span> </a></span><span id="/2017/03/22/结构型模式/" class="leancloud_visitors" data-flag-title="结构型模式">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数 </span><span class="leancloud-visitors-count"></span></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="结构型模式7个"><a href="#结构型模式7个" class="headerlink" title="结构型模式7个"></a>结构型模式7个</h3><p>适配器模式（Adapter）、桥接模式（Bridge）、装饰模式（Decorator）、组合模式（Composite）、外观模式（Facade）、享元模式（Flyweight）、代理模式（Proxy）</p><h3 id="装饰者模式（-Pattern）"><a href="#装饰者模式（-Pattern）" class="headerlink" title="装饰者模式（ Pattern）"></a>装饰者模式（ Pattern）</h3><p>装饰者模式（ Pattern）属于结构型模式，动态地将责任附加到对象上。<strong>若要扩展功能，装饰者提供了比继承更有弹性的替代方案。</strong>它是通过创建一个包装对象，通过包装对象来包裹真实的对象，以达到装饰目的。</p><p><img src="/pic/装饰者模式.png" alt="装饰者模式"></p><ul><li>Component：抽象组件，给具体类对象动态地添加职责。</li><li>ConcreteComponent：抽象组件的具体实现类。</li><li>Decorator：抽象装饰者，继承Component，用于拓展Component类的功能，但对于Component来说无需知道Decorator的存在。</li><li>ConcreteDecorator：装饰者具体实现类。</li></ul><p>咖啡添加了不同的调料，将收取不同的费用。因为调料数量众多，我们不能为每一种口味的咖啡创建一个类。<br></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 咖啡基类Coffee（被装饰者的基类）：</span></div><div class="line"><span class="keyword">class</span> Coffee &#123;</div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="built_in">string</span> description;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">cost</span><span class="params">()</span> </span>= <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="built_in">string</span> <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> description;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 以摩卡咖啡为例，实现具体咖啡类Mocha，最开始有自己的简单装饰：</span></div><div class="line"><span class="keyword">class</span> Mocha :<span class="keyword">public</span> Coffee &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Mocha() &#123;</div><div class="line">        description=<span class="string">"摩卡"</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//重写，返回价格</span></div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">10</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 抽象调料基类（CondimentDecorator，装饰者基类）用来对原味咖啡进行多层装饰，每层装饰增加一些配料。</span></div><div class="line"><span class="keyword">class</span> CondimentDecorator :<span class="keyword">public</span> Coffee &#123;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 装饰者奶泡类（Whip，装饰者的第一层）：</span></div><div class="line"><span class="keyword">class</span> Whip :<span class="keyword">public</span> CondimentDecorator &#123;</div><div class="line">    Coffee* coffee;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Whip(Coffee* coffee) &#123;</div><div class="line">        <span class="keyword">this</span>-&gt;coffee = coffee;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//价格增加0.5元</span></div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0.5</span> + coffee-&gt;cost();</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//增加第一层装饰</span></div><div class="line">    <span class="function"><span class="built_in">string</span> <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> coffee-&gt;getDescription() + <span class="string">"+奶泡"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 装饰者牛奶类（Milk，装饰者的第二层）：</span></div><div class="line"><span class="keyword">class</span> Milk :<span class="keyword">public</span> CondimentDecorator &#123;</div><div class="line">    Coffee* coffee;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Milk(Coffee* coffee) &#123;</div><div class="line">        <span class="keyword">this</span>-&gt;coffee = coffee;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//价格增加1.7元</span></div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">1.7</span> + coffee-&gt;cost();</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//增加第二层装饰</span></div><div class="line">    <span class="function"><span class="built_in">string</span> <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> coffee-&gt;getDescription() + <span class="string">"+牛奶"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    Coffee* mocha=<span class="keyword">new</span> Mocha;</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; mocha-&gt;getDescription() &lt;&lt; <span class="string">" 价格："</span> &lt;&lt; mocha-&gt;cost()&lt;&lt;<span class="built_in">endl</span>;</div><div class="line"></div><div class="line">    <span class="comment">//添加奶泡</span></div><div class="line">    Coffee* mocha1 = <span class="keyword">new</span> Whip(mocha);</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; mocha1-&gt;getDescription() &lt;&lt; <span class="string">" 价格："</span> &lt;&lt; mocha1-&gt;cost() &lt;&lt; <span class="built_in">endl</span>;</div><div class="line"></div><div class="line">    <span class="comment">//添加牛奶</span></div><div class="line">    mocha1 = <span class="keyword">new</span> Milk(mocha);</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; mocha1-&gt;getDescription() &lt;&lt; <span class="string">" 价格："</span> &lt;&lt; mocha1-&gt;cost() &lt;&lt; <span class="built_in">endl</span>;</div><div class="line"></div><div class="line">    <span class="comment">//添加奶泡和牛奶</span></div><div class="line">    mocha1 = <span class="keyword">new</span> Whip(mocha);</div><div class="line">    mocha1 = <span class="keyword">new</span> Milk(mocha1);</div><div class="line">    <span class="built_in">cout</span> &lt;&lt; mocha1-&gt;getDescription() &lt;&lt; <span class="string">" 价格："</span> &lt;&lt; mocha1-&gt;cost() &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    system(<span class="string">"pause"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p><strong>使用场景:</strong></p><ul><li>（1）在不必改变原类和使用继承的情况下，动态地扩展一个对象的功能。它是通过创建一个包装对象，也就是装饰来包裹真实的对象。</li><li>（2）当不能采用继承和组合的方式对系统进行扩充或者不利于系统扩展和维护时。</li></ul><h3 id="外观模式（Facade-Pattern）"><a href="#外观模式（Facade-Pattern）" class="headerlink" title="外观模式（Facade Pattern）"></a>外观模式（Facade Pattern）</h3><p>外观模式（Facade Pattern）属于结构型模式，提供了一个统一的接口（具体类），用来访问子系统的一群接口（具体类）。外观定义了一个高层接口，让子系统更容易使用。<br><img src="/pic/装饰者模式.png" alt="装饰者模式"></p><ul><li>Client：客户类，通过外观类与子系统进行交互。</li><li>Facade：外观类，知道哪些子系统类负责处理请求，将客户端的请求代理给适当的子系统对象。</li><li>Subsystem：子系统类，实现子系统功能，处理外观类指派的任务，注意子系统类不含有外观类的引用。</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 把《倚天屠龙记》张无忌当作一个系统，他作为一个武侠，本身分为三个子系统，分别是招式、内功和经脉。</span></div><div class="line"><span class="comment">// 三个子系统分别是招式、内功和经脉</span></div><div class="line"><span class="comment">//子系统招式</span></div><div class="line"><span class="keyword">class</span> ZhaoShi &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">taiJiQuan</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"使用着招式太极拳"</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">qiShangQuan</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"使用招式七伤拳"</span>&lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">shengHuoLing</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"使用招式圣火令"</span>&lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//子系统内功</span></div><div class="line"><span class="keyword">class</span> NeiGong &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">jiuYang</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"使用九阳神功"</span>&lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">qianKun</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"使用乾坤大挪移"</span>&lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//子系统经脉</span></div><div class="line"><span class="keyword">class</span> JingMai &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">jingMai</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"开启经脉"</span>&lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//外观类张无忌</span></div><div class="line"><span class="keyword">class</span> ZhangWuJi &#123;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    JingMai jingMai;</div><div class="line">    ZhaoShi zhaoShi;</div><div class="line">    NeiGong neiGong;</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    ZhangWuJi()&#123;&#125;</div><div class="line"></div><div class="line">    <span class="comment">//使用乾坤大挪移</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">qianKun</span><span class="params">()</span> </span>&#123;</div><div class="line">        jingMai.jingMai();<span class="comment">//开启经脉</span></div><div class="line">        neiGong.qianKun();<span class="comment">//使用内功乾坤大挪移</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//使用七伤拳</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">qiShang</span><span class="params">()</span> </span>&#123;</div><div class="line">        jingMai.jingMai(); <span class="comment">//开启经脉</span></div><div class="line">        neiGong.jiuYang(); <span class="comment">//使用内功九阳神功</span></div><div class="line">        zhaoShi.qiShangQuan();<span class="comment">//使用招式七伤拳</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p><strong>应用场景</strong></p><ul><li>（1）客户端需要与多个子系统交互时，可使用外观模式。如当维护一个遗留的大型系统时，可能这个系统难以维护和拓展，但因为含有重要功能，新的需求必须依赖于它，则可以使用外观类，来为这个粗糙复杂的遗留代码提供一个简单的类接口，让新系统和外观类交互，而外观类负责与遗留的代码进行交互。</li><li>（2）客户端程序与多个子系统之间存在很大的依赖性。引入外观类将子系统与客户以及其他子系统解耦，可以提高子系统的独立性和可移植性。</li></ul><h3 id="适配器模式（Adapter-Pattern）"><a href="#适配器模式（Adapter-Pattern）" class="headerlink" title="适配器模式（Adapter Pattern）"></a>适配器模式（Adapter Pattern）</h3><p>适配器模式（Adapter Pattern）属结构性模式，将一个类的接口转换成客户期望的另一个接口。适配器让原本接口不兼容的类可以合作无间。</p><p><img src="/pic/适配器模式.png" alt="适配器模式"></p><ul><li>Client：客户类。</li><li>Target：目标抽象类；</li><li>Adapter：适配器类；</li><li>Adaptee：适配者类；</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 用火鸡冒充鸭子的例子来讲解。</span></div><div class="line"><span class="comment">//抽象鸭类</span></div><div class="line"><span class="keyword">class</span> Duck &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>= <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>= <span class="number">0</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//绿头鸭</span></div><div class="line"><span class="keyword">class</span> MallardDuck &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"绿头鸭呱呱叫"</span>&lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"绿头鸭开始飞"</span>&lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 拥有火鸡类，火鸡同样可以叫和飞，但是叫声是咯咯叫，飞行也没有鸭子飞的远。</span></div><div class="line"><span class="keyword">class</span> Turkey &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">gobble</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"火鸡咯咯叫"</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"火鸡短距离飞"</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 可以使用适配器可以来包装火鸡对象和函数接口。</span></div><div class="line"><span class="keyword">class</span> TurkeyAdapter:<span class="keyword">public</span> Duck &#123;</div><div class="line">    Turkey turkey;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    TurkeyAdapter(<span class="keyword">const</span> Turkey &amp; turkey) : turkey(turkey)&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>&#123;</div><div class="line">        turkey.gobble();</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//火鸡飞行5次才能达到鸭子的飞行距离</span></div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i &lt; <span class="number">5</span>;++i)</div><div class="line">            turkey.fly();</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p><strong>应用场景</strong></p><ul><li>（1）系统需要使用现有的类，而这些类的接口不符合系统的需要。</li><li>（2）想要建立一个可以重复使用的类（适配器），用于与一些彼此之间没有太大关联的类建立联系。</li></ul><p><strong>适配器模式分为对象适配器和类适配器</strong>。前面所概述的是对象适配器。类适配器使用有限，因为类适配器需要使用多重继承，这个在java、C#中没有办法实现，但在C++中可以实现。<br><img src="/pic/类适配器.png" alt="类适配器"><br><strong>适配器模式</strong>（对象适配器）将一个对象包装起来改变其函数接口，来适应现有系统的需要; <strong>装饰者模式</strong>讲一个对象包装起来以增加新的行为和责任；而<strong>外观模式</strong>将一群对象包装起来，以简化其函数接口。</p><h3 id="组合模式"><a href="#组合模式" class="headerlink" title="组合模式"></a>组合模式</h3><p>将对象组合成树形结构以表示“部分-整体”的层次结构。组合使得用户对单个对象和组合对象的使用具有一致性。<br><img src="/pic/组合模式.gif" alt="组合模式"><br>FinanceDepartment、HRDepartment两个类作为叶结点，因此没有定义添加函数。而ConcreteCompany类可以作为中间结点，所以可以有添加函数。那么怎么添加呢？这个类中定义了一个链表，用来放添加的元素。<br></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Company</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Company(<span class="built_in">string</span> name) &#123; m_name = name; &#125;</div><div class="line">    <span class="keyword">virtual</span> ~Company()&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(Company *pCom)</span></span>&#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Show</span><span class="params">(<span class="keyword">int</span> depth)</span> </span>&#123;&#125;</div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="built_in">string</span> m_name;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//具体公司</span></div><div class="line"><span class="keyword">class</span> ConcreteCompany : <span class="keyword">public</span> Company</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    ConcreteCompany(<span class="built_in">string</span> name): Company(name) &#123;&#125;</div><div class="line">    <span class="keyword">virtual</span> ~ConcreteCompany() &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(Company *pCom)</span> </span>&#123; m_listCompany.push_back(pCom); &#125; <span class="comment">//位于树的中间，可以增加子树</span></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">(<span class="keyword">int</span> depth)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; depth; i++)</div><div class="line">            <span class="built_in">cout</span>&lt;&lt;<span class="string">"-"</span>;</div><div class="line">        <span class="built_in">cout</span> &lt;&lt; m_name &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">        <span class="built_in">list</span>&lt;Company *&gt;::iterator iter=m_listCompany.begin();</div><div class="line">        <span class="keyword">for</span>(; iter != m_listCompany.end(); iter++) <span class="comment">//显示下层结点</span></div><div class="line">            (*iter)-&gt;Show(depth + <span class="number">2</span>);</div><div class="line">    &#125;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="built_in">list</span>&lt;Company *&gt; m_listCompany;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//具体的部门，财务部</span></div><div class="line"><span class="keyword">class</span> FinanceDepartment : <span class="keyword">public</span> Company</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    FinanceDepartment(<span class="built_in">string</span> name):Company(name)&#123;&#125;</div><div class="line">    <span class="keyword">virtual</span> ~FinanceDepartment() &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Show</span><span class="params">(<span class="keyword">int</span> depth)</span> <span class="comment">//只需显示，无限添加函数，因为已是叶结点</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; depth; i++)</div><div class="line">            <span class="built_in">cout</span>&lt;&lt;<span class="string">"-"</span>;</div><div class="line">        <span class="built_in">cout</span>&lt;&lt; m_name &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//具体的部门，人力资源部</span></div><div class="line"><span class="keyword">class</span> HRDepartment :<span class="keyword">public</span> Company</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    HRDepartment(<span class="built_in">string</span> name):Company(name)&#123;&#125;</div><div class="line">    <span class="keyword">virtual</span> ~HRDepartment() &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Show</span><span class="params">(<span class="keyword">int</span> depth)</span> <span class="comment">//只需显示，无限添加函数，因为已是叶结点</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; depth; i++)</div><div class="line">            <span class="built_in">cout</span>&lt;&lt;<span class="string">"-"</span>;</div><div class="line">        <span class="built_in">cout</span>&lt;&lt; m_name &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p></p><h3 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h3><p>为其他对象提供一种代理以控制对这个对象的访问。有四种常用的情况：（1）远程代理，（2）虚代理，（3）保护代理，（4）智能引用。本文主要介绍虚代理和智能引用两种情况。<br><img src="/pic/代理模式.gif" alt="代理模式"><br>考虑一个可以在文档中嵌入图形对象的文档编辑器。有些图形对象的创建开销很大。但是打开文档必须很迅速，因此我们在打开文档时应避免一次性创建所有开销很大的对象。这里就可以运用代理模式，在打开文档时，并不打开图形对象，而是打开图形对象的代理以替代真实的图形。待到真正需要打开图形时，仍由代理负责打开。<br></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">class</span> Image</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Image(<span class="built_in">string</span> name): m_imageName(name) &#123;&#125;</div><div class="line">    <span class="keyword">virtual</span> ~Image() &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    <span class="built_in">string</span> m_imageName;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">class</span> BigImage: <span class="keyword">public</span> Image</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    BigImage(<span class="built_in">string</span> name):Image(name) &#123;&#125;</div><div class="line">    ~BigImage() &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> </span>&#123; <span class="built_in">cout</span>&lt;&lt;<span class="string">"Show big image : "</span>&lt;&lt;m_imageName&lt;&lt;<span class="built_in">endl</span>; &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">class</span> BigImageProxy: <span class="keyword">public</span> Image</div><div class="line">&#123;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    BigImage *m_bigImage;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    BigImageProxy(<span class="built_in">string</span> name):Image(name),m_bigImage(<span class="number">0</span>) &#123;&#125;</div><div class="line">    ~BigImageProxy() &#123; <span class="keyword">delete</span> m_bigImage; &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(m_bigImage == <span class="literal">NULL</span>)</div><div class="line">            m_bigImage = <span class="keyword">new</span> BigImage(m_imageName);</div><div class="line">        m_bigImage-&gt;Show();</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    Image *image = <span class="keyword">new</span> BigImageProxy(<span class="string">"proxy.jpg"</span>); <span class="comment">//代理</span></div><div class="line">    image-&gt;Show(); <span class="comment">//需要时由代理负责打开</span></div><div class="line">    <span class="keyword">delete</span> image;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><h3 id="享元模式"><a href="#享元模式" class="headerlink" title="享元模式"></a>享元模式</h3><p>享元模式的主要目的是实现对象的共享，即共享池，当系统中对象多的时候可以减少内存的开销，通常与工厂模式一起使用。<br><img src="/pic/享元模式.jpg" alt="享元模式"><br>FlyWeightFactory负责创建和管理享元单元，当一个客户端请求时，工厂需要检查当前对象池中是否有符合条件的对象，如果有，就返回已经存在的对象，如果没有，则创建一个新对象，FlyWeight是超类。</p><p>在围棋中，棋子就是大量细粒度的对象。其属性有内在的，比如颜色、形状等，也有外在的，比如在棋盘上的位置。<strong>内在的属性是可以共享的，区分在于外在属性</strong>。因此，可以这样设计，只需定义两个棋子的对象，一颗黑棋和一颗白棋，这两个对象含棋子的内在属性；<strong>棋子的外在属性</strong>，即在棋盘上的位置可以提取出来，存放在单独的容器中。相比之前的方案，现在容器中仅仅存放了位置属性，而原来则是棋子对象。显然，现在的方案大大减少了对于空间的需求。<br></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//棋子颜色</span></div><div class="line"><span class="keyword">enum</span> PieceColor &#123;BLACK, WHITE&#125;;</div><div class="line"><span class="comment">//棋子位置</span></div><div class="line"><span class="keyword">struct</span> PiecePos</div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> x;</div><div class="line">    <span class="keyword">int</span> y;</div><div class="line">    PiecePos(<span class="keyword">int</span> a, <span class="keyword">int</span> b): x(a), y(b) &#123;&#125;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//棋子定义</span></div><div class="line"><span class="keyword">class</span> Piece</div><div class="line">&#123;</div><div class="line"><span class="keyword">protected</span>:</div><div class="line">    PieceColor m_color; <span class="comment">//颜色</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Piece(PieceColor color): m_color(color) &#123;&#125;</div><div class="line">    ~Piece() &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Draw</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">class</span> BlackPiece: <span class="keyword">public</span> Piece</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    BlackPiece(PieceColor color): Piece(color) &#123;&#125;</div><div class="line">    ~BlackPiece() &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Draw</span><span class="params">()</span> </span>&#123; <span class="built_in">cout</span>&lt;&lt;<span class="string">"绘制一颗黑棋\n"</span>; &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">class</span> WhitePiece: <span class="keyword">public</span> Piece</div><div class="line">&#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    WhitePiece(PieceColor color): Piece(color) &#123;&#125;</div><div class="line">    ~WhitePiece() &#123;&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Draw</span><span class="params">()</span> </span>&#123; <span class="built_in">cout</span>&lt;&lt;<span class="string">"绘制一颗白棋\n"</span>;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// 相应棋盘的定义为：</span></div><div class="line"><span class="keyword">class</span> PieceBoard</div><div class="line">&#123;</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    <span class="built_in">vector</span>&lt;PiecePos&gt; m_vecPos; <span class="comment">//存放棋子的位置</span></div><div class="line">    Piece *m_blackPiece;       <span class="comment">//黑棋棋子</span></div><div class="line">    Piece *m_whitePiece;       <span class="comment">//白棋棋子</span></div><div class="line">    <span class="built_in">string</span> m_blackName;</div><div class="line">    <span class="built_in">string</span> m_whiteName;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    PieceBoard(<span class="built_in">string</span> black, <span class="built_in">string</span> white): m_blackName(black), m_whiteName(white)</div><div class="line">    &#123;</div><div class="line">        m_blackPiece = <span class="literal">NULL</span>;</div><div class="line">        m_whitePiece = <span class="literal">NULL</span>;</div><div class="line">    &#125;</div><div class="line">    ~PieceBoard() &#123; <span class="keyword">delete</span> m_blackPiece; <span class="keyword">delete</span> m_whitePiece;&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">SetPiece</span><span class="params">(PieceColor color, PiecePos pos)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(color == BLACK)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(m_blackPiece == <span class="literal">NULL</span>)  <span class="comment">//只有一颗黑棋</span></div><div class="line">                m_blackPiece = <span class="keyword">new</span> BlackPiece(color);</div><div class="line">            <span class="built_in">cout</span>&lt;&lt;m_blackName&lt;&lt;<span class="string">"在位置("</span>&lt;&lt;pos.x&lt;&lt;<span class="string">','</span>&lt;&lt;pos.y&lt;&lt;<span class="string">")"</span>;</div><div class="line">            m_blackPiece-&gt;Draw();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(m_whitePiece == <span class="literal">NULL</span>)</div><div class="line">                m_whitePiece = <span class="keyword">new</span> WhitePiece(color);</div><div class="line">            <span class="built_in">cout</span>&lt;&lt;m_whiteName&lt;&lt;<span class="string">"在位置("</span>&lt;&lt;pos.x&lt;&lt;<span class="string">','</span>&lt;&lt;pos.y&lt;&lt;<span class="string">")"</span>;</div><div class="line">            m_whitePiece-&gt;Draw();</div><div class="line">        &#125;</div><div class="line">        m_vecPos.push_back(pos);</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p></p><h3 id="桥接模式"><a href="#桥接模式" class="headerlink" title="桥接模式"></a>桥接模式</h3><p>桥接模式就是把事物和其具体实现分开，使他们可以各自独立的变化。桥接的用意是：将抽象化与实现化解耦，使得二者可以独立变化。<br><img src="/pic/桥接模式.gif" alt="桥接模式"><br>考虑装操作系统，有多种配置的计算机，同样也有多款操作系统。如何运用桥接模式呢？可以将操作系统和计算机分别抽象出来，让它们各自发展，减少它们的耦合度。当然了，两者之间有标准的接口。这样设计，不论是对于计算机，还是操作系统都是非常有利的。<br></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//操作系统</span></div><div class="line"><span class="keyword">class</span> OS</div><div class="line">&#123;</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">      <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">InstallOS_Imp</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">class</span> WindowOS: <span class="keyword">public</span> OS</div><div class="line">&#123;</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">      <span class="function"><span class="keyword">void</span> <span class="title">InstallOS_Imp</span><span class="params">()</span> </span>&#123; <span class="built_in">cout</span>&lt;&lt;<span class="string">"安装Window操作系统"</span>&lt;&lt; <span class="built_in">endl</span>; &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">class</span> LinuxOS: <span class="keyword">public</span> OS</div><div class="line">&#123;</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">      <span class="function"><span class="keyword">void</span> <span class="title">InstallOS_Imp</span><span class="params">()</span> </span>&#123; <span class="built_in">cout</span>&lt;&lt;<span class="string">"安装Linux操作系统"</span>&lt;&lt; <span class="built_in">endl</span>; &#125;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//计算机</span></div><div class="line"><span class="keyword">class</span> Computer</div><div class="line">&#123;</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">      <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">InstallOS</span><span class="params">(OS *os)</span> </span>&#123;&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">class</span> DellComputer: <span class="keyword">public</span> Computer</div><div class="line">&#123;</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">      <span class="function"><span class="keyword">void</span> <span class="title">InstallOS</span><span class="params">(OS *os)</span> </span>&#123; os-&gt;InstallOS_Imp(); &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">class</span> AppleComputer: <span class="keyword">public</span> Computer</div><div class="line">&#123;</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">      <span class="function"><span class="keyword">void</span> <span class="title">InstallOS</span><span class="params">(OS *os)</span> </span>&#123; os-&gt;InstallOS_Imp(); &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure><p></p></div><div></div><div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/软件设计模式-cpp/" rel="tag">#软件设计模式 cpp</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2017/03/22/创建型模式/" rel="next" title="创建型模式"><i class="fa fa-chevron-left"></i> 创建型模式</a></div><div class="post-nav-prev post-nav-item"></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Sambeau Wang"><p class="site-author-name" itemprop="name">Sambeau Wang</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">21</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories"><span class="site-state-item-count">6</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags"><span class="site-state-item-count">5</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/SambeauWang" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub </a></span><span class="links-of-author-item"><a href="sambeauwang@gmail.com" target="_blank" title="Gmail"><i class="fa fa-fw fa-gmail"></i> Gmail</a></span></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#结构型模式7个"><span class="nav-number">1.</span> <span class="nav-text">结构型模式7个</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#装饰者模式（-Pattern）"><span class="nav-number">2.</span> <span class="nav-text">装饰者模式（ Pattern）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#外观模式（Facade-Pattern）"><span class="nav-number">3.</span> <span class="nav-text">外观模式（Facade Pattern）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#适配器模式（Adapter-Pattern）"><span class="nav-number">4.</span> <span class="nav-text">适配器模式（Adapter Pattern）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组合模式"><span class="nav-number">5.</span> <span class="nav-text">组合模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#代理模式"><span class="nav-number">6.</span> <span class="nav-text">代理模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#享元模式"><span class="nav-number">7.</span> <span class="nav-text">享元模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#桥接模式"><span class="nav-number">8.</span> <span class="nav-text">桥接模式</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2017</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Sambeau Wang</span></div><div class="powered-by"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>本站总访问量 <span id="busuanzi_value_site_pv"></span> &nbsp&nbsp&nbsp 您是第<span id="busuanzi_value_site_uv"></span>个来到的小伙伴</div><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script><script type="text/javascript">function run_disqus_script(s){var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src="//"+disqus_shortname+".disqus.com/"+s,(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(i)}var disqus_shortname="sambeaublog.disqus.com/admin",disqus_identifier="2017/03/22/结构型模式/",disqus_title="结构型模式",disqus_url="https://sambeauwang.github.io/2017/03/22/结构型模式/";run_disqus_script("count.js");var disqus_config=function(){this.page.url=disqus_url,this.page.identifier=disqus_identifier,this.page.title=disqus_title};run_disqus_script("embed.js")</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("MmTla9uHtyvAotAPz2aHArnn-gzGzoHsz","ppTjU9IN1rosOHlnsYjpxXJe")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){var t=".leancloud-visitors-count";if(0===e.length)return void o.find(t).text(0);for(var i=0;i<e.length;i++){var r=e[i],s=r.get("url"),l=r.get("time"),c=document.getElementById(s);$(c).find(t).text(l)}for(var i=0;i<n.length;i++){var s=n[i],c=document.getElementById(s),u=$(c).find(t);""==u.text()&&u.text(0)}}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var r=new e,s=new AV.ACL;s.setPublicReadAccess(!0),s.setPublicWriteAccess(!0),r.setACL(s),r.set("title",o),r.set("url",n),r.set("time",1),r.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script></body></html>