<!doctype html><html class="theme-next mist use-motion"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css" rel="stylesheet" type="text/css"><link href="//fonts.useso.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css"><meta name="keywords" content="Python,"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2"><meta name="description" content="改善python程序-库"><meta property="og:type" content="article"><meta property="og:title" content="改善python程序-库"><meta property="og:url" content="http://yoursite.com/2017/02/17/改善python程序-库/index.html"><meta property="og:site_name" content="Sambeau"><meta property="og:description" content="改善python程序-库"><meta property="og:updated_time" content="2017-02-17T13:28:47.099Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="改善python程序-库"><meta name="twitter:description" content="改善python程序-库"><script type="text/javascript" id="hexo.configuration">var NexT=window.NexT||{},CONFIG={scheme:"Mist",sidebar:{position:"left",display:"hide"},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"博主"}}</script><link rel="canonical" href="http://yoursite.com/2017/02/17/改善python程序-库/"><title>改善python程序-库 | Sambeau</title></head><body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans"><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-86063343-1","auto"),ga("send","pageview")</script><div class="container one-collumn sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="//schema.org/WPHeader"><div class="header-inner"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Sambeau</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section">首页</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section">分类</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section">归档</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section">标签</a></li><li class="menu-item menu-item-schedule"><a href="/schedule" rel="section">日程</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="st-search-show-outputs">搜索</a></li></ul><div class="site-search"><form class="site-search-form"><input type="text" id="st-search-input" class="st-search-input st-default-search-input"></form><script type="text/javascript">!function(t,e,n,s,c,a,i){t.SwiftypeObject=c,t[c]=t[c]||function(){(t[c].q=t[c].q||[]).push(arguments)},a=e.createElement(n),i=e.getElementsByTagName(n)[0],a.async=1,a.src=s,i.parentNode.insertBefore(a,i)}(window,document,"script","//s.swiftypecdn.com/install/v2/st.js","_st"),_st("install","YjoQj_U5CFYfraaUGKBM","2.0.0")</script></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="//schema.org/Article"><header class="post-header"><h1 class="post-title" itemprop="name headline">改善python程序-库</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time itemprop="dateCreated" datetime="2017-02-17T21:28:18+08:00" content="2017-02-17">2017-02-17 </time></span><span class="post-category">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span> </a></span></span><span class="post-comments-count">&nbsp; | &nbsp; <a href="/2017/02/17/改善python程序-库/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/02/17/改善python程序-库/" itemprop="commentsCount"></span> </a></span><span id="/2017/02/17/改善python程序-库/" class="leancloud_visitors" data-flag-title="改善python程序-库">&nbsp; | &nbsp; <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数 </span><span class="leancloud-visitors-count"></span></span></div></header><div class="post-body" itemprop="articleBody"><p>#库</p><h3 id="掌握字符串的基本用法"><a href="#掌握字符串的基本用法" class="headerlink" title="掌握字符串的基本用法"></a>掌握字符串的基本用法</h3><h5 id="性质判定"><a href="#性质判定" class="headerlink" title="性质判定"></a>性质判定</h5><p><strong>isalnum()、isalpha()、isdigit()、islower()、isupper()、isspace()、istitle()、 startswith(prefix[，start[, end]])、endswith(suffix[，start[, end]])</strong>,前面几个is*()形式的函数很简单，顾名思义无非是判定是否数字、字母、大小写、空白符之类的，istitle()作为东方人用得 少些，它是判定字符串是否每个单词都有且只有第一个字母是大写的。</p><h5 id="査找与替换"><a href="#査找与替换" class="headerlink" title="査找与替换"></a>査找与替换</h5><p><strong>count(sub[,start[,end]])、find(sub[,start[,end]])、index(sub[,start[,end]])、rfind(sub[,start[,end]])、rindex(sub[,start[,end]])</strong>这些方法都接受start、end参数.其中count()能够査找子串sub在字符串中出现的次数.此外,需要注意find()和index()方法的不同：find()函数族找不到时返回-1，index()函数族则抛出ValueError异常。<br>replace(old,new[,count])用以替换字符串的某些子串,如果指定count参数的话,就最多 替换count次,如果不指定,就全部替换.</p><h5 id="字符串的分切与连接"><a href="#字符串的分切与连接" class="headerlink" title="字符串的分切与连接"></a>字符串的分切与连接</h5><p><strong>partition(sep)、rpartition(sep)、splitlines([keepends])、split([sep[,maxsplit]])、rsplit([sep[,maxsplit]]), *partition()</strong>函数族是接受一个字符串参数,并返回一个3个元素的元组对象.如果sep没 出现在母串中,返回值是(sep,”,”);否则，返回值的第一个元素是sep左端的部分，第二个元素是sep自身，第三个元素是sep右端的部分.而spHt()的参数maxsplit是分切的次数，即最大的分切次数，所以返回值最多有maxsplit+1个元素.</p><h5 id="变形"><a href="#变形" class="headerlink" title="变形"></a>变形</h5><p><strong>lower()、upper()、capitalize()、swapcase()、title(),titile()</strong>的功能是将每一个单词的首字母大写,并将单词中的非首字母转换为小写</p><h5 id="删减与填充"><a href="#删减与填充" class="headerlink" title="删减与填充"></a>删减与填充</h5><p>删减是<strong>strip([chars])、lstrip([chars])、rstrip([chars])</strong>中的chars参数没有指定，就是删除空白符，空白符由string.whitespace常量定义.</p><hr><h3 id="按需选择sort-或者sorted"><a href="#按需选择sort-或者sorted" class="headerlink" title="按需选择sort()或者sorted()"></a>按需选择sort()或者sorted()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>sorted(iterable[, cmp[, key[, reverse]]]&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>s.sort([cmp(key[, reverse]]]&#125;</div></pre></td></tr></table></figure><ul><li>cmp为用户定义的任何比较函数，函数的参数为两个可比较的元素，函数根据第一个参数与第二个参数的关系依次返回-1、0或者+1(第一个参数小于第二个参数则返回负数)。</li><li>key是带一个参数的函数，用来为每个元素提取比较值</li><li>reverse表示排序结果是否反转<h5 id="sorted-函数会返回一个排序后的列表-原有列表保持不变-而Sort-函数会直接修改原有列表"><a href="#sorted-函数会返回一个排序后的列表-原有列表保持不变-而Sort-函数会直接修改原有列表" class="headerlink" title="sorted()函数会返回一个排序后的列表,原有列表保持不变;而Sort()函数会直接修改原有列表"></a>sorted()函数会返回一个排序后的列表,原有列表保持不变;而Sort()函数会直接修改原有列表</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a=[ <span class="string">'1'</span>, <span class="string">'a'</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="string">'n'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>sorted (a)</div><div class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="string">'1'</span>, <span class="string">'a'</span>, <span class="string">'n'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">[ <span class="string">'1'</span>, <span class="string">'a'</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="string">'n'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> a.sort()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="string">'1'</span>, <span class="string">'a'</span>, <span class="string">'n'</span>]</div></pre></td></tr></table></figure></li></ul><h5 id="对字典进行排序"><a href="#对字典进行排序" class="headerlink" title="对字典进行排序"></a>对字典进行排序</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; phonebook = &#123; &apos; Linda&apos; : &apos;7750 &apos;, &apos;Bob&apos; : &apos; 9345&apos;, &apos;Carol&apos; : &apos; 5834 &apos; &#125;</div><div class="line">&gt;&gt;&gt; from operator import itemgetter</div><div class="line">&gt;&gt;&gt; sorted_pb = sorted (phonebook.iteriterns (), key=itemgetter (1))</div><div class="line">&gt;&gt;&gt; print sorted_pb</div><div class="line">[(&apos;Carol&apos;, &apos;5834&apos;), (&apos;Linda&apos;, &apos;7750&apos;), (&apos;Bob1,&apos;9345&apos;)]</div></pre></td></tr></table></figure><h5 id="多维list排序"><a href="#多维list排序" class="headerlink" title="多维list排序"></a>多维list排序</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#分别表示学生的姓名，成绩，等级</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>gameresult = [[<span class="string">'Bob'</span>, <span class="number">95.00</span>,<span class="string">'A'</span>]，[<span class="string">'Alan'</span>,<span class="number">86.0</span>, <span class="string">'B'</span>], [<span class="string">'Mandy'</span>,<span class="number">82.5</span>,<span class="string">'A'</span>], [<span class="string">'Rob'</span>,</div><div class="line"><span class="number">86</span>, <span class="string">'E'</span>]]</div><div class="line"></div><div class="line"><span class="comment">#当第二个字段成绩相同的时候按照等级从低到高排序</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>sorted (gameresult,key=operator.itemgetter(<span class="number">2</span>, <span class="number">1</span>))</div><div class="line">[[<span class="string">'Mandy'</span>, <span class="number">82.5</span>,<span class="string">'A'</span>],   [<span class="string">'Bob'</span>, <span class="number">95.0</span>,<span class="string">'A'</span>], [<span class="string">'Alan'</span>, <span class="number">86.0</span>,<span class="string">'C'</span>],[<span class="string">'Rob'</span>,<span class="number">86</span>,,<span class="string">'E'</span>]]</div></pre></td></tr></table></figure><h5 id="字典中混合list排序"><a href="#字典中混合list排序" class="headerlink" title="字典中混合list排序"></a>字典中混合list排序</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; mydict = &#123;</div><div class="line">...             &apos;Li&apos;: [&apos;M&apos;, 7],</div><div class="line">...             Zhang,:[&apos;E&apos;, 2],</div><div class="line">...             &apos;Wang&apos;: [&apos;P&apos;,3],</div><div class="line">...             &apos;Du&apos;: [&apos;C&apos;,2],</div><div class="line">...             &apos;Zhe&apos;: [&apos;H&apos;,7]&#125;</div><div class="line"></div><div class="line">&gt;&gt;&gt; from operator import itemgetter</div><div class="line">&gt;&gt;&gt; sorted(mydict.iteritems(), key»lambda (k,v): operator.itemgetter(1)(v))</div></pre></td></tr></table></figure><h5 id="List中混合宇典排序"><a href="#List中混合宇典排序" class="headerlink" title="List中混合宇典排序"></a>List中混合宇典排序</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>gameresult = [&#123; <span class="string">"name"</span>:<span class="string">"Bob"</span>, <span class="string">"wins"</span>:<span class="number">10</span>, <span class="string">"losses"</span>:<span class="number">3</span>, <span class="string">"rating"</span>:<span class="number">75.00</span> &#125;,&#123; <span class="string">"name"</span>:<span class="string">"David"</span>, <span class="string">"wins"</span>:<span class="number">3</span>, <span class="string">"losses"</span>:<span class="number">5</span>, <span class="string">"rating"</span>:<span class="number">57.00</span> &#125;]</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>sorted(gameresult , key=operator.itemgetter(<span class="string">"rating"</span>,<span class="string">"name"</span>))</div></pre></td></tr></table></figure><hr><h3 id="使用copy模块深拷贝对象"><a href="#使用copy模块深拷贝对象" class="headerlink" title="使用copy模块深拷贝对象"></a>使用copy模块深拷贝对象</h3><p>(1)浅拷贝:构造一个新的复合对象并将从原对象中发现的引用插人该对象中。浅拷贝的实现方式有多种，如工厂函数、切片操作、copy模块中的copy操作等,如“copy.copy(customerl)”<br>(2)深拷贝:也构造一个新的复合对象,但是遇到引用会继续递归拷贝其所指向的具体内容，也就是说它会针对引用所指向的对象继续执行拷贝，因此产生的对象不受其他引用对象操作的影响。深拷贝的实现需要依赖copy模块的deepcopy()操作,如“copy.deepcopy(customerl)”</p><h3 id="使用Counter进行计数统计"><a href="#使用Counter进行计数统计" class="headerlink" title="使用Counter进行计数统计"></a>使用Counter进行计数统计</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>some_data = [<span class="string">'a'</span>,<span class="string">'2'</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="string">'2'</span>,<span class="string">'b'</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="string">'a'</span>,<span class="number">5</span>,<span class="string">'d'</span>,<span class="string">'a'</span>,<span class="string">'z'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> Counter(some_data)</div><div class="line">Counter(&#123;<span class="string">'a'</span>: <span class="number">3</span>, <span class="number">4</span>: <span class="number">2</span>, <span class="number">5</span>: <span class="number">2</span>, <span class="string">'2'</span>: <span class="number">2</span>, <span class="number">2</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">1</span>, <span class="number">7</span>: <span class="number">1</span>, <span class="string">'z'</span>: <span class="number">1</span>, <span class="string">'d'</span>: <span class="number">1</span>&#125;)</div></pre></td></tr></table></figure><p><strong>使用elements()方法来获取Counter中的key值</strong><br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>list (Counter(some_data).elements())</div><div class="line">[<span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="number">2</span>, <span class="string">'b'</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="string">'2'</span>, <span class="string">'2'</span>, <span class="string">'z'</span> <span class="string">'d'</span>]</div></pre></td></tr></table></figure><p></p><p><strong>利用most_common()方法可以找出前N个出现频串最高的元累以及它们对应的次数</strong><br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>Counter (some_data) .most_common (<span class="number">2</span>)</div><div class="line">[(<span class="string">'a'</span>, <span class="number">3</span>), (<span class="number">4</span>:<span class="number">2</span>)]</div></pre></td></tr></table></figure><p></p><p>update()方法用于被统计对象元素的更新,原有count()计数的对象与新增元素的统计计数值相加而不是直接替换它们.<br>subtmct()方法用于实现计数器对象中元素统计值相减,输人和输出的统计值允许为0或者负数。<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>c = Counter (<span class="string">"success"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c.update(<span class="string">"successfully"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c</div><div class="line">Counter(&#123;<span class="string">'s'</span>: <span class="number">6</span>,<span class="string">'c'</span>: <span class="number">4</span>, <span class="string">'u'</span>:<span class="number">3</span>,<span class="string">'e'</span>:<span class="number">2</span>,<span class="string">'f'</span>:<span class="number">1</span>,<span class="string">'l'</span>:<span class="number">2</span>,<span class="string">'y'</span>:<span class="number">1</span>&#125;)</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c.subtract(<span class="string">"successfully"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>c</div><div class="line">Counter (&#123; <span class="string">'s'</span>:<span class="number">3</span>, <span class="string">'c'</span>:<span class="number">2</span>, <span class="string">'e'</span>:<span class="number">1</span>, <span class="string">'u'</span>: <span class="number">1</span>, <span class="string">'f'</span>:<span class="number">0</span>,...&#125;)</div></pre></td></tr></table></figure><p></p><hr><h3 id="深入掌握ConfigParser"><a href="#深入掌握ConfigParser" class="headerlink" title="深入掌握ConfigParser"></a>深入掌握ConfigParser</h3><p>在ConfigParser支持的配置文件格式里,有一个[DEFAULT]节,当读取的配置项在不在指定的节里时, ConfigParser将会到[DEFAULT]节中査找.<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 配罝文件：</span></div><div class="line">$ cat example.conf</div><div class="line">[DEFAULT]</div><div class="line">in_default = <span class="string">'an option value in default'</span></div><div class="line">[section1]</div><div class="line"></div><div class="line">$ cat readini.py</div><div class="line"><span class="keyword">import</span> ConfigParser</div><div class="line">conf = ConfigParser.ConfigParser ()</div><div class="line">conf.read(<span class="string">'example.conf'</span>)</div><div class="line"><span class="keyword">print</span> conf.get(<span class="string">'sectionl'</span>,<span class="string">'in_default'</span>)</div><div class="line"></div><div class="line"><span class="comment"># 运行结果如下</span></div><div class="line">$ python readini.py</div><div class="line"><span class="string">'an option value in default'</span></div></pre></td></tr></table></figure><p></p><h5 id="配置项值的査找规则如下"><a href="#配置项值的査找规则如下" class="headerlink" title="配置项值的査找规则如下"></a>配置项值的査找规则如下</h5><ul><li>如果找不到节名，就拋出NoSectionError。</li><li>如果给定的配置项出现在get()方法的vars参数中，则返回vars参数中的值。</li><li>如果在指定的节中含有给定的配置项，则返回其值。</li><li>如果在[DEFAULT]中有指定的配置项，则返回其值。</li><li>如果在构造函数的defaults参数中有指定的配置项，则返回其值。</li><li>拋出NoOptionError</li></ul><h5 id="ConfigParser支持类似Python中字符串格式化"><a href="#ConfigParser支持类似Python中字符串格式化" class="headerlink" title="ConfigParser支持类似Python中字符串格式化"></a>ConfigParser支持类似Python中字符串格式化</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">$ cat format.conf</div><div class="line">[DEFAULT]</div><div class="line">conn_str = <span class="string">'%(dbn)s://%(user)s:%(pw)s@%(host)s:%(port)s/%(db)s'</span></div><div class="line">dbn = mysql</div><div class="line">user = root</div><div class="line">host = localhost</div><div class="line">port = <span class="number">3306</span></div><div class="line">[dbl]</div><div class="line">user = aaa</div><div class="line">pw=ppp</div><div class="line">db = example</div><div class="line">[db2]</div><div class="line">host = <span class="number">192.168</span><span class="number">.0</span><span class="number">.110</span></div><div class="line">pw = www</div><div class="line">db = example</div><div class="line"></div><div class="line"><span class="comment"># 通过不同的节名来获取格式化后的值时，根据不同配置，得到不同的值</span></div><div class="line">$ cat readformatini.py</div><div class="line"><span class="keyword">import</span> ConfigParser</div><div class="line">conf = ConfigParser.ConfigParser()</div><div class="line">conf.read(<span class="string">'format.conf'</span>)</div><div class="line"><span class="keyword">print</span> conf.get(<span class="string">'dbl'</span>, <span class="string">'conn_str'</span>)</div><div class="line"><span class="keyword">print</span> conf.get(<span class="string">'db2'</span>, <span class="string">'conn_str'</span>)</div><div class="line"></div><div class="line">$ python readformatini.py</div><div class="line">mysql ://aaa : ppp@localhost: <span class="number">3306</span>/example</div><div class="line">mysql ://root: www@<span class="number">192.168</span><span class="number">.0</span><span class="number">.110</span>: <span class="number">3306</span>/example</div></pre></td></tr></table></figure><h5 id="getboolean-根据一定的规则将配置项的值转换为布尔值"><a href="#getboolean-根据一定的规则将配置项的值转换为布尔值" class="headerlink" title="getboolean()根据一定的规则将配置项的值转换为布尔值"></a>getboolean()根据一定的规则将配置项的值转换为布尔值</h5><p>getboolean()的真值规则: no、false和off都会被转义为False,而对应的1、yes、true和on则都被转义为True,其他值都会导致抛出VahieError异常。</p><hr><h3 id="使用argparse处理命令行参数"><a href="#使用argparse处理命令行参数" class="headerlink" title="使用argparse处理命令行参数"></a>使用argparse处理命令行参数</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line">import argparse</div><div class="line"></div><div class="line">parser = argparse.ArgumentParser()</div><div class="line"></div><div class="line">parser.add_argument('-s', action='store', dest='simple_value',</div><div class="line">        help='Store a simple value')</div><div class="line"></div><div class="line">parser.add_argument('-c', action='store_const', dest='constant_value',</div><div class="line">        const='value-to-store',</div><div class="line">        help='Store a constant value')</div><div class="line"></div><div class="line">parser.add_argument('-t', action='store_true', default=False,</div><div class="line">        dest='boolean_switch',</div><div class="line">        help='Set a switch to true')</div><div class="line">parser.add_argument('-f', action='store_false', default=False,</div><div class="line">        dest='boolean_switch',</div><div class="line">        help='Set a switch to false')</div><div class="line"></div><div class="line">parser.add_argument('-a', action='append', dest='collection',</div><div class="line">        default=[],</div><div class="line">        help='Add repeated values to a list')</div><div class="line"></div><div class="line">parser.add_argument('-A', action='append_const', dest='const_collection',</div><div class="line">        const='value-1-to-append',</div><div class="line">        default=[],</div><div class="line">        help='Add different values to list')</div><div class="line">parser.add_argument('-B', action='append_const', dest='const_collection',</div><div class="line">        const='value-2-to-append',</div><div class="line">        help='Add different values to list')</div><div class="line"></div><div class="line">parser.add_argument('--version', action='version', version='%(prog)s 1.0')</div><div class="line"></div><div class="line">results = parser.parse_args()</div><div class="line">print 'simple_value     =', results.simple_value</div><div class="line">print 'constant_value   =', results.constant_value</div><div class="line">print 'boolean_switch   =', results.boolean_switch</div><div class="line">print 'collection       =', results.collection</div><div class="line">print 'const_collection =', results.const_collection</div><div class="line"></div><div class="line">$ python argparse_action.py -h</div><div class="line"></div><div class="line">usage: argparse_action.py [-h] [-s SIMPLE_VALUE] [-c] [-t] [-f]</div><div class="line">                          [-a COLLECTION] [-A] [-B] [--version]</div><div class="line"></div><div class="line">optional arguments:</div><div class="line">  -h, --help       show this help message and exit</div><div class="line">  -s SIMPLE_VALUE  Store a simple value</div><div class="line">  -c               Store a constant value</div><div class="line">  -t               Set a switch to true</div><div class="line">  -f               Set a switch to false</div><div class="line">  -a COLLECTION    Add repeated values to a list</div><div class="line">  -A               Add different values to list</div><div class="line">  -B               Add different values to list</div><div class="line">  --version        show program's version number and exit</div><div class="line"></div><div class="line">$ python argparse_action.py -s value</div><div class="line"></div><div class="line">simple_value     = value</div><div class="line">constant_value   = None</div><div class="line">boolean_switch   = False</div><div class="line">collection       = []</div><div class="line">const_collection = []</div></pre></td></tr></table></figure><h5 id="支持类型增多"><a href="#支持类型增多" class="headerlink" title="支持类型增多"></a>支持类型增多</h5><p>在type参数的值不再是一个字符串,而是一个可调用对象,比如在add_option()调用时是type=”int”,而在add_argument()调用时直接写type=im就可以了.argparse还支持文件类型.<br>扩展类型可调用任何对象,比如函数都可以作为type的实参.与type类似,choices参数也支持更多的类型.<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">parser.add_argument(<span class="string">'door'</span>, type=int, choices=range(<span class="number">1</span>, <span class="number">4</span>))</div></pre></td></tr></table></figure><p></p><p>add_argument()提供了对必填参数的支持，只要把required参数设置为True传递进去，当缺失这一参数时，argparse就会自动退出程序，并提示用户。</p><h5 id="支持参数分组"><a href="#支持参数分组" class="headerlink" title="支持参数分组"></a>支持参数分组</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>parser = argparse.ArgumentParser(prog=<span class="string">'PROG'</span>, add_help=<span class="keyword">False</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>group1 = parser.add_argument_group(<span class="string">'group1'</span>, <span class="string">'groupl description'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>group1.add_argument(<span class="string">'foo'</span>, help = <span class="string">'foo help'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>group2 = parser.add_argument_group(<span class="string">'group2'</span>, <span class="string">'group2 description'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>group2 .add_argument (<span class="string">'--bar'</span>, help=<span class="string">'bar help'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>parser.print_help()</div><div class="line"></div><div class="line">usage: PROG [--bar BAR] foo</div><div class="line">group1:</div><div class="line">    group1  description</div><div class="line">    foo     foo help</div><div class="line">group2:</div><div class="line">    group2 description</div><div class="line">    --bar  BAR bar help</div></pre></td></tr></table></figure><h5 id="支持子命令"><a href="#支持子命令" class="headerlink" title="支持子命令"></a>支持子命令</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> argparse</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>parser = argparse.ArgumentParser(prog=<span class="string">' PROG'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>subparsers = parser.add_subparsers(help=<span class="string">'sub-command help'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>parser_a = subparsers.add_parser(<span class="string">'a'</span>, help=<span class="string">'a help'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>parser_a.add_argument(<span class="string">'--bar'</span>, type=int, help=<span class="string">'bar help'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>parser.parse_args([<span class="string">'a'</span>, <span class="string">'--bar'</span>, <span class="string">'1'</span>])</div><div class="line">Namespace(bar=l)</div></pre></td></tr></table></figure><hr><h3 id="使用pandas处理大型CSV文件-一种逗号分隔型值的纯文本格式文件"><a href="#使用pandas处理大型CSV文件-一种逗号分隔型值的纯文本格式文件" class="headerlink" title="使用pandas处理大型CSV文件(一种逗号分隔型值的纯文本格式文件)"></a>使用pandas处理大型CSV文件(一种逗号分隔型值的纯文本格式文件)</h3><h5 id="常见的API"><a href="#常见的API" class="headerlink" title="常见的API"></a>常见的API</h5><p><strong>1) reader(csvfile[,dialect=’excel’][,fmtparam])</strong><br>参数csvfile需要是支持迭代(Iterator)的对象，通常对文件(file)对象或者列表(list)对象都是适用的，并且每次调用next()方法的返回值是字符串(string);参数dialect的默认值为excel,;fmtparam是一系列参数列表，主要用于需要覆盖默认的Dialect 设置的情形。<br><strong>2) csv.writer(csvfile,dialect=’excer’，</strong>fmtparams),用于写入CSV 文件**<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">with</span> open(<span class="string">'data.csv'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> csvfile:</div><div class="line">    csvwriter=csv.writer(csvfile, dialect=<span class="string">'excel'</span>,delimiter=<span class="string">"|"</span>,quotechar=<span class="string">'H'</span>, quoting=csv.QUOTE_MINIMAL)</div><div class="line">    csvwriter.writerow ([<span class="string">"1/3/09 14:44"</span>,<span class="string">"'Productl'"</span>,<span class="string">"1200''"</span>,<span class="string">"Visa"</span>,<span class="string">"Gouya"</span>])</div><div class="line"><span class="comment">#写入行输出形式为：</span></div><div class="line"><span class="number">1</span>/<span class="number">3</span>/<span class="number">09</span> <span class="number">14</span>:<span class="number">44</span> | <span class="string">'Productl'</span> |<span class="number">1200</span><span class="string">''</span> |Visa|Gouya</div></pre></td></tr></table></figure><p></p><p><strong>3)csv.DictReader(csvfile, fieldnames=None, restkey=None, restval=None, dialect-exceP, *args，</strong>kwds)<strong><br>将读入的信息映射到一个字典中去,其中字典的key由fieldnames指定,该值省略的话将使用CSV文件第一行的数据作为key值.如果读入行的字段的个数大于filednames中指定的个数,多余的字段名将会存放在restkey中,而restval主要用于当读取行的域的个数小于fieldnames的时候，它的值将会被用作剩下的key对应的值. </strong>4)csv.DietWriter(csvflle, fieldnames, restval=’’, extrasaction=’raise’, dialect=’excer’, <em>args, <em>*kwds&gt;</em></em><br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> csv</div><div class="line"><span class="keyword">with</span> open (<span class="string">'test.csv'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> csv_file:</div><div class="line">    <span class="comment">#设置列名称</span></div><div class="line">    FIELDS = [<span class="string">'Transaction__date'</span>, <span class="string">'Product'</span>, <span class="string">'Price'</span>, <span class="string">'Payment__Type'</span>]</div><div class="line">    writer = csv. DictWriter(csv_file, fieldnames=FIELDS)</div><div class="line">    <span class="comment"># 參写入列名称</span></div><div class="line">    writer.writerow(diet(zip(FIELDS, FIELDS)))</div><div class="line">    d = &#123;<span class="string">'Transaction_date1'</span>:<span class="string">'1/2/09 6:17'</span>, <span class="string">'Product'</span>:<span class="string">'Productl'</span>, <span class="string">'Price'</span>: <span class="string">'1200'</span>,<span class="string">'Payment_Type'</span>:<span class="string">'Mastercard'</span>&#125;</div><div class="line">    <span class="comment"># 写入一行</span></div><div class="line">    Writer .writerow (d)</div><div class="line"></div><div class="line"><span class="keyword">with</span> open (<span class="string">'test.csv'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> csv_file:</div><div class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> csv.DictReader(csv_file):</div><div class="line">        <span class="keyword">print</span> d</div><div class="line"><span class="comment">#output d is:&#123;'Product':'Productl','Transaction_date': '1/2/09 6:17','Price':'1200','Payment_Type': 'Mastercard'&#125;</span></div></pre></td></tr></table></figure><p></p><h5 id="Pandas的使用"><a href="#Pandas的使用" class="headerlink" title="Pandas的使用"></a>Pandas的使用</h5><p>Pandas支持多种文件格式处理，包括CSV、HDF5、HTML等,其支持的两种数据结构——Series和DataFrame—是数据处理的基础。<br><strong>(1)Series:</strong>它是一种类似数组的带索引的一维数据结构。如果不指定索引，默认为0到N-1。通过obj.valuesO和obj.indexO可以分别获取值和索引。当给Series传递一个字典的时候，Series的索引将根据字典中的键排序。如果传入字典的时候同时重新指定了index参数，当index与字典中的键不匹配的时候，会出现时数据丢失的情况，标记为NaN。<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>objl = Series([l,<span class="string">'a'</span>,(<span class="number">1</span>,<span class="number">2</span>),<span class="number">3</span>], index=[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>,<span class="string">'d'</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>objl</div><div class="line">a   <span class="number">1</span></div><div class="line">b   a</div><div class="line">c   (<span class="number">1</span>, <span class="number">2</span>)</div><div class="line">d   <span class="number">3</span></div><div class="line">dtype: object</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>obj2=Series (&#123;<span class="string">"Book"</span>:<span class="string">"Python"</span>, <span class="string">"Author"</span>:<span class="string">"Dan"</span>, <span class="string">"ISBN"</span>:<span class="string">"011334"</span>, <span class="string">"Price"</span>:<span class="number">25</span>&#125;,index=[<span class="string">'book'</span>,<span class="string">'Author'</span>,<span class="string">'ISBM'</span>,<span class="string">'Price'</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>obj2 . isnull ()</div><div class="line">book    <span class="keyword">True</span>    <span class="comment">#指定的index与字典的鍵不匹配，发生数据丟失</span></div><div class="line">Author  <span class="keyword">False</span></div><div class="line">ISBM    <span class="keyword">True</span>    <span class="comment">#指定的index与字典的鍵不匹配，发生数据丟失</span></div><div class="line">Price   <span class="keyword">False</span></div><div class="line">dtype: bool</div></pre></td></tr></table></figure><p></p><p><strong>(2)DataFrame:</strong>其数据为排好序的数据列的集合，每一列都可以是 不同的数据类型，索引会自动分配并且能根据指定的列进行排序。构建一个DataFrame最常用的方式是用一个相等长度列表的字典或NumPy数组。DataFrame也可以通过columns指定序列的顺序进行 排序。<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>data = &#123;<span class="string">'OrderDate'</span>: [<span class="string">'l-e-lO'</span>, <span class="string">'1-23-10'</span>, <span class="string">'2-9-10'</span>, <span class="string">'2-26-10'</span>, <span class="string">'13-15-10'</span>], <span class="string">'Region'</span>:[<span class="string">'East'</span>, <span class="string">'Central'</span>, <span class="string">'Central'</span>, <span class="string">'West'</span>, <span class="string">'East'</span>], <span class="string">'Rep'</span>: [<span class="string">'Jones'</span>, <span class="string">'Kivell'</span>, <span class="string">'Jardine'</span>, <span class="string">'Gill'</span>, <span class="string">'Sorvino'</span>]&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>DataFrame(data, columns= [<span class="string">'OrderDate'</span>,<span class="string">'Region'</span>, <span class="string">'Rep'</span>]&#125;</div><div class="line">    OrderDate   Region  Rep</div><div class="line"><span class="number">0</span>   <span class="number">1</span><span class="number">-6</span><span class="number">-10</span>  East    Jones</div><div class="line"><span class="number">1</span>   <span class="number">1</span><span class="number">-23</span><span class="number">-10</span> Central Kivell</div><div class="line"><span class="number">2</span>   <span class="number">2</span><span class="number">-9</span><span class="number">-10</span>  Central Jardine</div><div class="line"><span class="number">3</span>   <span class="number">2</span><span class="number">-26</span><span class="number">-10</span> West    Gill</div><div class="line"><span class="number">4</span>   <span class="number">3</span><span class="number">-15</span><span class="number">-10</span> East    Sorvino</div></pre></td></tr></table></figure><p></p><h6 id="Pandas中处理CSV文件的函数"><a href="#Pandas中处理CSV文件的函数" class="headerlink" title="Pandas中处理CSV文件的函数"></a>Pandas中处理CSV文件的函数</h6><p>read_csv()和to_csv()这两个,其中read_csv()读取CSV文件的内容并返回DataFmme, to_csv()则是其逆过程<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># csv文件</span></div><div class="line"><span class="comment"># OrderDate,Region,Rep,Item,Units,Unit Cost,Total 1-6-10,Eastf Jones,Pencil,95, 1.99 , 189.05</span></div><div class="line"><span class="comment"># 1-23-10,Central,Binder,SO, 19.99 , 999.50</span></div><div class="line"><span class="comment"># 2-9-10,Central,Jardine,Pencil/ 36, 4.99 , 179.64</span></div><div class="line"><span class="comment"># 2-26-10,Central,Gill,Pen,27, 19.99 , 539.73</span></div><div class="line"><span class="comment"># 3-15-10,WestfPencil,56/ 2.99 , 167.44</span></div><div class="line"><span class="comment"># 4-1-10,East,Jones,Binder, 60, 4.99 , 299.40 4-18-10,Central,Andrews,Pencil, 75, 1.99 , 149.25</span></div><div class="line"></div><div class="line"><span class="comment"># 方法read_csv()的参数nrows指定读取文件的行数，usecols指定所要读取的列的列名</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.read_csv(<span class="string">"SampleData.csv"</span>, nrows=<span class="number">5</span>, usecols=[<span class="string">'OrderDate'</span>, <span class="string">'Item'</span>, <span class="string">'Total'</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>df</div><div class="line">    OrderDate   Item    Total</div><div class="line"><span class="number">0</span>   <span class="number">1</span><span class="number">-6</span><span class="number">-10</span>  Pencil  <span class="number">189.05</span></div><div class="line"><span class="number">1</span>   <span class="number">1</span><span class="number">-23</span><span class="number">-10</span> Binder  <span class="number">999.50</span></div><div class="line"><span class="number">2</span>   <span class="number">2</span><span class="number">-9</span><span class="number">-10</span>  Pencil  <span class="number">179.64</span></div><div class="line"><span class="number">3</span>   <span class="number">2</span><span class="number">-26</span><span class="number">-10</span> Pen <span class="number">539.73</span></div><div class="line"><span class="number">4</span>   <span class="number">3</span><span class="number">-15</span><span class="number">-10</span> Pencil  <span class="number">167.44</span></div><div class="line"></div><div class="line"><span class="comment"># 设置CSV文件与excel兼容。dialect参数可以是string也可以是csv.Dialect的实例</span></div><div class="line"><span class="comment"># 如果文件格式改为使用“丨”分隔符，则需要设置dialect相关的参数。</span></div><div class="line"><span class="comment"># error_ bad_lines设置为False，当记录不符合要求的时候，如记录所包含的列数与文件列设置不相 等时可以直接忽略这些列。</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dia = csv.excel ()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dia.delimiter = <span class="string">"|"</span>   <span class="comment"># 设置分隔符</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>pd.read_csv(<span class="string">"SD.csv"</span>)</div><div class="line">    OrderDateI Region I Rep I Item I Units I Unit Cost I Total</div><div class="line"><span class="number">0</span>   <span class="number">1</span><span class="number">-6</span><span class="number">-101</span> East I Jones I Pencil <span class="number">19511.99</span> <span class="number">1189.05</span></div><div class="line"><span class="number">1</span>   <span class="number">1</span><span class="number">-23</span><span class="number">-10</span>|Central|Kivell|Binder|<span class="number">50</span>|<span class="number">19.99</span> <span class="number">1999.50</span>...</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>pd.read_csv(<span class="string">"SD.csv"</span>,dialect =dia,error_bad_lines=<span class="keyword">False</span>)</div><div class="line">Skipping line <span class="number">3</span>: expected <span class="number">7</span> fields, saw <span class="number">10</span>  <span class="comment">#所有不符合格式要求的列将直接忽略</span></div><div class="line">    OrderDate Region Rep Item Units Unit Cost Total</div><div class="line"><span class="number">0</span>   <span class="number">1</span><span class="number">-6</span><span class="number">-10</span> East Jones Pencil <span class="number">95</span> <span class="number">1.99</span> <span class="number">189.05</span></div><div class="line"></div><div class="line"><span class="comment"># 对文件进行分块处理并返回一个可迭代的对象</span></div><div class="line"><span class="comment"># 参数chunksize设置分块的文件行数</span></div><div class="line"><span class="comment"># 将参数iterator设置为True时，返回值为TextFileReader,它是一个可迭代对</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>reader = pd.read_table(<span class="string">"SampleData.csv"</span>, chunksize=<span class="number">10</span>, iterator=<span class="keyword">True</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>reader</div><div class="line">&lt;pandas.io.parsers.TextFileReader object at <span class="number">0x0314BE70</span>&gt;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>iter(reader).next()  <span class="comment"># 将 TextFileReader 转换为迭代器并调用 next 方法</span></div><div class="line">OrderDate, Region, Rep, Item, Units, Unit Cost, Total <span class="comment"># 毎次读入 10 行</span></div><div class="line"><span class="number">0</span>   <span class="number">1</span><span class="number">-6</span><span class="number">-10</span>, East,Jones,Pencil,<span class="number">95</span>, <span class="number">1.99</span> • <span class="number">189.05</span></div><div class="line"><span class="number">1</span>   <span class="number">1</span><span class="number">-23</span><span class="number">-10</span>,Central,Kiveil,Binder,<span class="number">50</span>, <span class="number">19.99</span> , <span class="number">999.50</span></div><div class="line"><span class="number">2</span>   <span class="number">2</span><span class="number">-9</span><span class="number">-10</span>,Central,Jardine,Pencil, <span class="number">36</span>, <span class="number">4.99</span> , <span class="number">179.64</span></div><div class="line">...</div><div class="line"></div><div class="line"><span class="comment"># 支持多个文件合并处理</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>filelst = os.listdir(<span class="string">"test"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> filelst    <span class="comment">#同时存在3个格式相同的文件</span></div><div class="line">(<span class="string">'si.csv'</span>,  <span class="string">'s2.csv'</span>, <span class="string">'s3.csv'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>os.chdir(<span class="string">"test"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>dfs = [pd.read_csv(f) <span class="keyword">for</span> f <span class="keyword">in</span> filelst]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>total_df = pd.concat(dfs)  <span class="comment"># 将文件合并</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>total_df</div><div class="line">    OrderDate   Region  Rep Item    Units   Unit Cost   Total</div><div class="line"><span class="number">0</span>   <span class="number">1</span><span class="number">-6</span><span class="number">-10</span>  East    Jones   Pencil  <span class="number">95</span>  <span class="number">1.99</span>    <span class="number">189.05</span></div><div class="line"><span class="number">1</span>   <span class="number">1</span><span class="number">-23</span><span class="number">-10</span> Central Kivell  Binder  <span class="number">50</span>  <span class="number">19.99</span>   <span class="number">999.5</span></div></pre></td></tr></table></figure><p></p><hr><h3 id="使用ElementTree解析XML"><a href="#使用ElementTree解析XML" class="headerlink" title="使用ElementTree解析XML"></a>使用ElementTree解析XML</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">&lt;systems&gt;</div><div class="line">    &lt;system platform="linuxM name="linuxtest"&gt;</div><div class="line">        &lt;purpose&gt;automation test&lt;/purpose&gt;</div><div class="line">        &lt;system_type&gt;virtual&lt;/system_type&gt;</div><div class="line">        &lt;ip_address/&gt;</div><div class="line">        &lt;commands_on_boot&gt;</div><div class="line">            &lt;command_details&gt;</div><div class="line">                &lt;!-- Set root password.--&gt;</div><div class="line">                &lt;command&gt;echo rootrmytestpwd I sudo /usr/ sbin/chpasswd&lt;/command&gt;</div><div class="line">                &lt;userid&gt;root2&lt;/userid&gt;</div><div class="line">                &lt;password&gt;PasswOrd&lt;/password&gt;</div><div class="line">            &lt;/command_details&gt;</div><div class="line">            &lt;command_detai1s &gt;</div><div class="line">                &lt;c&lt;MTfnand&gt;mkdir /TEST; chmod 111 /TEST&lt;/command&gt;</div><div class="line">            &lt;/command_details&gt;</div><div class="line">        &lt;/commands_on_boot&gt;</div><div class="line">    &lt;/system&gt;</div><div class="line">    &lt;system platform="aix" name=MaixtestM&gt;</div><div class="line">        &lt;purpose&gt;manual test&lt;/purpose&gt;</div><div class="line">        &lt;system_type&gt;virtual&lt;/system_type&gt;</div><div class="line">        &lt;ip_address/&gt;</div><div class="line">        &lt;commands_on_boot&gt;</div><div class="line">            &lt;command details〉</div><div class="line">                &lt;!-- Set root password.--&gt;</div><div class="line">                &lt;command&gt;echo root:mytestpwd | sb in/chpasswd&lt;/command&gt;</div><div class="line">                &lt;userid&gt;root2&lt;/userid&gt;</div><div class="line">                &lt;password&gt;PasswOrd&lt;/password&gt;</div><div class="line">            &lt;/command details&gt;</div><div class="line">            &lt;command_details&gt;</div><div class="line">                &lt;command&gt;mkdir /TEST; chmod 777 /TEST&lt;/cornmand&gt;</div><div class="line">            &lt;/command_details&gt;</div><div class="line">        &lt;/commands on boot&gt;</div><div class="line">    &lt;/system&gt;</div><div class="line">&lt;/systems&gt;</div></pre></td></tr></table></figure><p>模块ElementTree主要存在两种类型ElementTree和Element</p><h5 id="ElementTree主要的方法和使用示例"><a href="#ElementTree主要的方法和使用示例" class="headerlink" title="ElementTree主要的方法和使用示例"></a>ElementTree主要的方法和使用示例</h5><table><thead><tr><th>主要的方法、属性</th><th>方法说明以及示例</th></tr></thead><tbody><tr><td>getroot()</td><td>返回xml文档的根节点 &gt;&gt;&gt; import xml.etrce.ElementTree as ET &gt;&gt;&gt; tree = ET.ElementTrce(file =”test.xral”) &gt;&gt;&gt; root = tree.getroot() &gt;&gt;&gt; print root<print root.tag="" systems=""></print></td></tr><tr><td>find(match) findall(match) findtext(match, dcfault=None)</td><td>同Element相关的方法类似，只是从跟节点开始搜索（见表冬2) &gt;&gt;&gt; for i in,root.findall(“system/purpose”): … print i.text automation test manual test &gt;&gt;&gt; print root.findtext(wsystem/purpose”) automation test &gt;&gt;&gt; print root.find(“system/purpose”) 〈Element purpose at 0x26d2170&gt;</td></tr><tr><td>iter(tag=None)</td><td>从xm丨根结点开始，根据传人的元素的tag返回所有的元索集合的迭代器 &gt;&gt;&gt; for i in tree.iter(tag=”command”): … print i.tcxt echo root:mytestpwd</td><td>sudo /usr/sbin/chpasswd mkdir /TEST; chmod 777 /TEST echo root:mytestpwd</td><td>sudo /usr/sbin/chpasswd mkdir /TEST; chmod 777 /TEST</td></tr><tr><td>iterfind(match)</td><td>根据传人的lag名称或者path以迭代器的形式返回所有的子元素 &gt;&gt;&gt; for i in,tree-iterfindCsystem/purpose”): … print i.text automation test manual test</td></tr></tbody></table><h5 id="Element主要的方法和使用示例"><a href="#Element主要的方法和使用示例" class="headerlink" title="Element主要的方法和使用示例"></a>Element主要的方法和使用示例</h5><table><thead><tr><th>主要的方法、属性</th><th>方法说明以及示例</th></tr></thead><tbody><tr><td>tag</td><td>字符串.用来表示元素所代表的名称&gt;&gt;&gt; print root[l].tag # 输出 system</td></tr><tr><td>text</td><td>表示元索所对应的具体值&gt;&gt;&gt; print root丨l].text # 输出空串</td></tr><tr><td>attrib</td><td>用字典表示的元素的属性&gt;&gt;&gt; print root[l].attrib # 输出{•platform<em>: ’aix’, ‘name</em>: ’sixtest’}</td></tr><tr><td>gct(kcy, default=Nonc)</td><td>根据元素属性字典的key值获取对应的值，如果找不到对应的厲性，则返回,default &gt;&gt;&gt; print root[l].attrib.get(“platform”）# 输出 aix</td></tr><tr><td>itcms()</td><td>将元素届性以（名称，值）的形式返冋&gt;&gt;&gt; print root[l].items() ^[(‘platform’, ‘aix’),(‘name’, ‘aixtest’)]</td></tr><tr><td>keys()</td><td>返回元素属性的key值集合&gt;&gt;&gt; print root[l].keys() # 输出[’platform’，•name’]</td></tr><tr><td>find(match)</td><td>根据传入的tag名称或者path返回第一个对应的element对象，或者返回 None</td></tr><tr><td>findall(match)</td><td>根据传入的tag名称或者path以列表的形式返回所有符合条件的元索</td></tr><tr><td>findtext(match, default=None)</td><td>根据传人的tag名称或者path返回第一个对应的element对象对应的值，即 text属性，如果找不到则返回default的设置</td></tr><tr><td>list(elem)</td><td>根据传入的元素的名称返冋其所有的子节点&gt;&gt;&gt; for i in list(root.findall(“system/system_typeM)):… print i.text</td></tr></tbody></table><h5 id="iteiparse的使用示例：统计userid在整个XML出现的次数"><a href="#iteiparse的使用示例：统计userid在整个XML出现的次数" class="headerlink" title="iteiparse的使用示例：统计userid在整个XML出现的次数"></a>iteiparse的使用示例：统计userid在整个XML出现的次数</h5><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; count = 0</div><div class="line">&gt;&gt;&gt; for event, elein in ET.iterparse("test. xml"): # 对 iterparse 的返回值进行迭代</div><div class="line">...     if event =='end':</div><div class="line">...         if elem.tag ==,userid':</div><div class="line">...             count+=l</div><div class="line">...     elem.clear()</div><div class="line">&gt;&gt;&gt; print count 2</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure><hr><h3 id="理解模块pickle优劣"><a href="#理解模块pickle优劣" class="headerlink" title="理解模块pickle优劣"></a>理解模块pickle优劣</h3><p>pickle中最主要的两个函数对为dumpO和load()</p><ul><li>pickle.dump(obj, file[, protocol]):序列化数据到一个文件描述符（一个打开的文件、<br>套接字等)。参数obj表示需要序列化的对象，包括布尔、数字、字符串、字节数组、 None、列表、元组、字典和集合等基本数据类型，此外pidke还能够处理循环，递归引用对象、类、函数以及类的实例等。参数file支持write()方法的文件句柄，可以为真实的文件，也可以是Stringl()对象等。protocol为序列化使用的协议版本，0表示 ASCII协议，所序列化的对象使用可打印的ASCII码表示；1表示老式的二进制协议;2表示2.3版本引人的新二进制协议</li><li>load(file):表示把文件中的对象恢复为原来的对象，这个过程也被称为反序列化。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> cPickle <span class="keyword">as</span> pickle</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>my_data = &#123;<span class="string">"name"</span> : <span class="string">"Python"</span>, <span class="string">"type"</span> : <span class="string">"Language"</span>, <span class="string">"version"</span> : <span class="string">"2-7.5"</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fp = open(<span class="string">"picklefile.dat"</span>, <span class="string">"wb"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>pickle.dump(my_data, fp)    <span class="comment">#使用 dump 进行序列化</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fp.close()</div><div class="line"></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fp = open(<span class="string">"picJclefile.dat"</span>, <span class="string">"rb"</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>out = pickle.load(fp)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>print(out)</div><div class="line">&#123;<span class="string">"name"</span> : <span class="string">"Python"</span>, <span class="string">"type"</span> : <span class="string">"Language"</span>, <span class="string">"version"</span> : <span class="string">"2-7.5"</span>&#125;</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>fp.close ()</div></pre></td></tr></table></figure><p><strong>(1)支持的数据类型广泛:</strong>如数字、布尔值、宇符串，只包含可序列化对象的元组、字 典、列表等，非嵌套的函数、类以及通过类的<em>dict</em>或者<em>getstate</em>()可以返回序列化对象的实例等。<br><strong>(2)pickle模块是可以扩展的:</strong>对于实例对象，pickle在还原对象的时候一般是不调<br>函数的，如果要调用<em>init</em>()进行初始化，对于古典类可以在类定义中提供<strong>getinitargs</strong>()函数，并返回一个元组，当进行unpickle的时候，Python就会自动调用 <strong>init_(),并把getinitargs()中返回的元组作为参数传递给</strong>init<strong>(),而对于新式类，可以提供<em>getnewargs</em>()来提供对象生成时候的参数，在unpickle的时候以Class.<em>new</em> (Class, *arg)的方式创建对象。对于不可序列化的对象，如sockets、文件句柄、数据库连 接等，也可以通过实现pickle协议来解决这些局限，主要是通过特殊方法</strong>getstate<strong>()和</strong>setstate__()来返回实例在被pickle时的状态。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> cPickle <span class="keyword">as</span> pickle</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TextReader</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,filename)</span>:</span></div><div class="line">        self.filename = filename</div><div class="line">        self.file = open(filename)</div><div class="line">        self.postion = self.file.tell () <span class="comment"># 文件的位置</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">readline</span><span class="params">(self)</span>:</span></div><div class="line">        line = self.file.readline()</div><div class="line">        self.postion = self.file.tell()</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> line:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line">        <span class="keyword">if</span> line.endswith(<span class="string">'\n'</span>):</div><div class="line">            line = line[:-l]</div><div class="line">        <span class="keyword">return</span> <span class="string">"%i: %s"</span> %(self.postion, line)</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_getstate_</span><span class="params">(self)</span> :</span>              <span class="comment"># 记录文件被pickle时候的状态</span></div><div class="line">        state = self.__diet__.copy ()   <span class="comment"># 获取被 pickle 时的字典信息</span></div><div class="line">        <span class="keyword">del</span> state[<span class="string">'file'</span>]</div><div class="line">        <span class="keyword">return</span> state</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_setstate</span> <span class="params">(self, state)</span> :</span>       <span class="comment"># 设置反序列化后的状态</span></div><div class="line">        self.__diet__.update(state)</div><div class="line">        file = open(self.filename)</div><div class="line">        self.file = file </div><div class="line"></div><div class="line">reader = TextReader(<span class="string">"zen.txt"</span>)</div><div class="line">print(reader.readline ())</div><div class="line">print(reader.readline())</div><div class="line">s = pickle.dumps(reader)        <span class="comment"># 在 dumps 的时候会默认调用 _getstate_</span></div><div class="line">news_reader = pickle.loads(s)    <span class="comment"># 在 loads 的时候会默认调用 setstate_</span></div><div class="line">print(new_reader.readline())</div></pre></td></tr></table></figure><p>(3)维护对象间的引用,如果一个对象上存在多个引用，pickle后不会改变对象间的引用，并且能够自动处理循环和递归引用。<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="string">'a'</span>, <span class="string">'b'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b = a</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>b.append(<span class="string">'c'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>p = pickle.dumps((a,b))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>al,bl = pickle.loads(p)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>al</div><div class="line">[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>bl</div><div class="line">[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a.append(<span class="string">'d'</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>bl</div><div class="line">[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>]</div></pre></td></tr></table></figure><p></p><hr><h3 id="序列化的另一个不错的选择——JSON"><a href="#序列化的另一个不错的选择——JSON" class="headerlink" title="序列化的另一个不错的选择——JSON"></a>序列化的另一个不错的选择——JSON</h3><p>Python的标准库JSON提供的最常用的方法是dump/dumps用来序列化，load/loads用来反序列化。需要注意的json默认不支持非ASCII-based的编码，如load方法可能在处理中文字符时不能正常显示，则需要通过 encoding参数指定对应的宇符编码</p><h5 id="JSON文档的构成非常简单，仅存在以下两大数据结构"><a href="#JSON文档的构成非常简单，仅存在以下两大数据结构" class="headerlink" title="JSON文档的构成非常简单，仅存在以下两大数据结构"></a>JSON文档的构成非常简单，仅存在以下两大数据结构</h5><ul><li>称/值对的集合。在各种语言中，它被实现为一个对象、记录、结构、字典、散列<br>表、键列表或关联数组</li><li>值的有序列表<h5 id="json模块利用了编码（JSONEncoder-和解码类（JSONDecoder-拓展其他类型"><a href="#json模块利用了编码（JSONEncoder-和解码类（JSONDecoder-拓展其他类型" class="headerlink" title="json模块利用了编码（JSONEncoder)和解码类（JSONDecoder)拓展其他类型"></a>json模块利用了编码（JSONEncoder)和解码类（JSONDecoder)拓展其他类型</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> datetime</div><div class="line"><span class="keyword">from</span> time <span class="keyword">import</span> mktime</div><div class="line"><span class="keyword">try</span>:</div><div class="line">    <span class="keyword">import</span> simplejson <span class="keyword">as</span> json</div><div class="line"><span class="keyword">except</span> ImportError: <span class="keyword">import</span> json</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DateTimeEncoder</span> <span class="params">(json. JSONEncoder)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">default</span><span class="params">(self, obj)</span>:</span></div><div class="line">        <span class="keyword">if</span> isinstance(obj, datetime.datetime):</div><div class="line">            <span class="keyword">return</span> obj.strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>)</div><div class="line">        <span class="keyword">elif</span> isinstance(obj, date):</div><div class="line">            <span class="keyword">return</span> obj.strftime(<span class="string">"%Y-%m-%d"</span>)</div><div class="line">        <span class="keyword">return</span> json.JSONEncoder.default(self, obj)</div><div class="line"></div><div class="line">d=datetime.datetime.now()</div><div class="line"><span class="keyword">print</span> json.dumps(d, cls=DateTimeEncoder)</div></pre></td></tr></table></figure></li></ul><hr><h3 id="使用traceback获取栈信息"><a href="#使用traceback获取栈信息" class="headerlink" title="使用traceback获取栈信息"></a>使用traceback获取栈信息</h3><p>程序运行会输出异常发生时候完整的栈信息，包括调用顺序、异常发生的语句、错误类型等.traceback.print_exc()方法打印出的信息包括3部分：错误类型、错误对应的值以及具体的trace信息，包括文件名、具体的行号、函数名以及对应的源代码。<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Traceback (most recent call last):</div><div class="line">File "trace.py", line 20, in &lt;module&gt;</div><div class="line">    f ()</div><div class="line">File "trace.py", line 5, in f</div><div class="line">    return g ()</div><div class="line">File ''trace.py", line 8, in g</div><div class="line">    return h()</div><div class="line">File "trace.py", line 12, in h</div><div class="line">    return i ()</div><div class="line">File "trace.py", line 16, in i</div><div class="line">    print gList [7]</div><div class="line">IndexError: list index out of range</div></pre></td></tr></table></figure><p></p><h5 id="常用的方法"><a href="#常用的方法" class="headerlink" title="常用的方法"></a>常用的方法</h5><p><strong>(1)traceback.print_exception(type, value, traceback[,file]])</strong>,根据limit的设置打印栈信息，file为None的情况下定位到sys.stderr,否则写入文件;其中type、value、 traceback这3个参数对应的值可以从sys.exc_info()中获取。<br><strong>(2)raceback.print_exc([limit[,file]])</strong>,为 print_exception()函数的缩写,不需要传入 type、 value、traceback 这3个参数。<br><strong>(3)traceback.format_exc([limit])</strong>,与print_exc()类似，区别在于返回形式为字符串。<br><strong>(4)traceback.extract_stack([file,[, limit]])</strong>,从当前帧中提取 trace信息。<br><strong>(5)本质上模块trackback获取异常相关的数据都是通过syS.exc_info()函数得到的</strong>.当有异常发生的时候，该函数以元组的形式返回(type, value，traceback), 其中type为异常的类型,value为异常本身,traceback为异常发生时候的调用和堆栈信息,它是一个traceback对象，对象中包含出错的行数、位置等数据。<br><strong>(6)inspect模块也提供了获取traceback对象的接口inspect.trace([conext])</strong>,可以返回当前帧对象以及异常发生时进行捕获的帧对象之间的所有栈帧记录列表，因此第一个记录代表当前调用对象，最后一个代表异常发生时候的对象。其中每一个列表元素都是一个由6个元素组成的元组:(frame对象,文件名,当前行号,函数名,源代码列表,当前行在源代码列表中的位置)</p><hr><h3 id="使用logging记录日志信息"><a href="#使用logging记录日志信息" class="headerlink" title="使用logging记录日志信息"></a>使用logging记录日志信息</h3><p>logger的level分为5个级别, 可以通过Logger.setLevel(lvl)来设置，其中DEBUG为最低级别，CRITICAL为最高级别，默认的级别为WARNING。<br>| Level | 使用情形 |<br>|———-|————————————————————————-|<br>| DEBUG | 详细的信息，在追踪问题的时候使用 |<br>| INFO | 正常的信息 |<br>| WARNING | 一些不可预见的问题发生，或者将要发生.如磁盘空间低等，但不影响程序的运行 |<br>| ERROR | 由于某些严重的问题，程序中的一些功能受到影响 |<br>| CRITICAL | 严重的错误，或者程序本身不能够继续运行 |</p><h5 id="logging-lib包含以下4个主要对象"><a href="#logging-lib包含以下4个主要对象" class="headerlink" title="logging lib包含以下4个主要对象"></a>logging lib包含以下4个主要对象</h5><p><strong>(1)logger是程序信息输出的接口</strong>，并根据设置的日志级别或filter来决定哪些信息需要输出，并 将这些信息分发到其关联的handler。常用的方法有<strong>Logger.setLevel()、Logger.addHandler()、Logger.removeHandler()、Logger.addFilter()、Logger.debug()、Logger.info()、Logger. waming()、Logger.error()、etLogger()</strong><br><strong>(2)Handler用来处理信息的输出</strong>，可以将信息输出到控制台、文件或者网络。可以通过 Logger.addHandler()来给 logger 对象添加 handler,常用的 handler 有 StreamHandler 和FileHandler类。StreamHandler发送错误信息到流，而FileHandler类用于向文件输出日志信息，这两个handler定义在logging的核心模块中。其他的handler定义在logging.handles 模块中，如 HTTPHandler、SocketHandler。<br><strong>(3)Formatter决定log信息的格式</strong>，格式使用类似于％(&lt; dictionary key &gt;)s的形式来定义，如’％(asctime)s-%(levelname)s - %(message)s’。<br><strong>(4)Filter用来决定哪些信息需要输出</strong>。可以被handler和logger使用，支持层次关系，比如，如果设罝了filter名称为A.B的logger,则该logger和其子logger的信息会被输出，如 A.B、A.B.C.<br><strong>(5)logging.basicConfig([</strong>kwargs])提供对日志系统的基本配置**，默认使用StreamHandler和 Formatter并添加到root logger<br>| 格 式 | 描 述 |<br>|———-|———————————————————|<br>| filename | 指定FileHandler的文件名，而不是默认的StreamHandler |<br>| filcmodc | 打幵文件的模式，同open函数中的同名参数，默认为’a’ |<br>| format | 输出格式字符串 |<br>| datefmt | 日期格式 |<br>| level | 设置根logger的日志级别 |<br>| stream | 指定StrcamHandler。这个参数若与filename冲突，忽略stream |</p><h5 id="范例"><a href="#范例" class="headerlink" title="范例"></a>范例</h5><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">import traceback</div><div class="line">import sys</div><div class="line">import logging</div><div class="line">gList = ['a','b','c','d','e','f'g']</div><div class="line">logging.basicConfig( # K置日志的输出方式及格式</div><div class="line">    level=logging.DEBUG,</div><div class="line">    filename= 'log. txt',</div><div class="line">    filemode='w',</div><div class="line">    format=' % (asctime) s % (filename) s [line: % (lineno) d) % (Xevelname) s % (message) s ',)</div><div class="line"></div><div class="line">def f ():</div><div class="line">    gList[5]</div><div class="line">    logging.info('[INFO]:calling method g() in f()') # 记录正常的信患 return g()</div><div class="line">def g():</div><div class="line">    logging.info('[INFOJ:calling method h() in g()') return h() def h ():</div><div class="line">    logging.info('[INFO]：Delete element in gList in h()')</div><div class="line">    del gList[2]</div><div class="line">    logging.info('[INFO]:calling method i() in h()')</div><div class="line">    return i()</div><div class="line">def i ():</div><div class="line">    logging.info('[INFO]:Append element i to gList in i()')</div><div class="line">    gList.append('i')</div><div class="line">    print gList[7]</div><div class="line">    if __name__ == '__main__':</div><div class="line">        logging.debug('Information during calling f():')</div><div class="line"></div><div class="line">try:</div><div class="line">    f()</div><div class="line">except IndexError as ex:</div><div class="line">    print "Sorry, Exception occured, you accessed an element out of range"</div><div class="line">    ty,tv,tb = sys.exc_info()</div><div class="line">    logging.error("[ERROR]:Sorry,Exception occured,you accessed an element out of range")</div><div class="line">    logging.critical('object info:%s' %ex)</div><div class="line">    logging.critical ('Error Type:&#123;0&#125; Error Inforrration: &#123;1&#125;'.forrrat (ty, tv))</div><div class="line">    logging.critical (''.join (trackback.formt_tb(tb)))</div><div class="line"></div><div class="line">2013-06-26 12:05:18,923 traceexample.py[line:41] CRITICAL object info:list index out of range</div><div class="line">2013-06-26 12:05:18,923 traceexample.py[line:42] CRITICAL Error Type: &lt;type 'exceptions.IndexError'&gt;,Error Information:list index out of range</div><div class="line">2013-06-26 12:05:18,924 traceexaraple.py[line:43] CRITICAL File "traceexample.py", line 35, in &lt;module&gt;</div><div class="line">    f ()</div><div class="line">File "traceexample.py" line 15, in f</div><div class="line">    return g()</div><div class="line">File "traceexample.py" line 19, in g</div><div class="line">    return h()</div><div class="line">File "traceexample.py" line 25, in  h</div><div class="line">    return i()</div><div class="line">File wtraceexample.py" line 30, in  i</div><div class="line">    print gList[7]</div></pre></td></tr></table></figure><h5 id="控制运行输出到console"><a href="#控制运行输出到console" class="headerlink" title="控制运行输出到console"></a>控制运行输出到console</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">console = logging.StreamHandler()</div><div class="line">console.setLevel(logging.ERROR)</div><div class="line">formatter = logging.Formatter(<span class="string">'%(name)-12s: %(levelname)-8s %(message)s'</span>)</div><div class="line">console.setFormatter(formatter)</div><div class="line">logging.getLogger(<span class="string">''</span>).addHandler(console)</div></pre></td></tr></table></figure><hr><h3 id="使用threading模块编写多线程程序-thread和-threading"><a href="#使用threading模块编写多线程程序-thread和-threading" class="headerlink" title="使用threading模块编写多线程程序(thread和 threading)"></a>使用threading模块编写多线程程序(thread和 threading)</h3><p>Python多线程支持用两种方式来创建线程：一种是通过继承Thread类，重写它的run()方法(不是start()方法);另一种是创建一个threading.Thread对象，在它的初始化函数(<strong>init</strong>())中将可调用对象作为参数传入<br>(1)thread模块只提供了一种锁类型thread_LockType,而threading模块中不仅有Lock指令锁、RLock可重入指令锁,支持条件变量Condition,信号量Semaphore,BoundedSemaphore以及Event事件等<br>(2)threading中的join()方法能够阻塞当前上下文环境的线程,直到调用此方法的线程终止或到达指定的timeout<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> threading, time,sys</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,name,delay)</span>:</span></div><div class="line">        threading.Thread.__init__(self)</div><div class="line">        self.name = name</div><div class="line">        self.delay = delay</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">print</span> <span class="string">"%s delay for %s"</span> %(self.name,self.delay)</div><div class="line">        time.sleep(self.delay)</div><div class="line">        c = <span class="number">0</span></div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">"This is thread %s on line %s"</span> %(self.namer c)</div><div class="line">            c = c + <span class="number">1</span></div><div class="line">            <span class="keyword">if</span> c == <span class="number">3</span>:</div><div class="line">                <span class="keyword">print</span> <span class="string">"End of thread %s"</span> %self.name</div><div class="line">                <span class="keyword">break</span></div><div class="line"></div><div class="line">tl = test(<span class="string">'Thread 1'</span>, <span class="number">2</span>)</div><div class="line">t2 = test(<span class="string">'Thread 2'</span>, <span class="number">2</span>)</div><div class="line">tl.start()</div><div class="line"><span class="keyword">print</span> <span class="string">"Wait tl to end"</span></div><div class="line">tl.join()</div><div class="line">t2.start()</div><div class="line"><span class="keyword">print</span> <span class="string">"End of main"</span></div></pre></td></tr></table></figure><p></p><p>主线程main在tl上使用join()的方法，主线程会等待tl结束后才继续运行后面的语句，由于线程t2的启动在join语句之后，t2一直等到tl退出后才会幵始运行。<br>(3)thread模块不支持守护线程,threading模块支持守护线程，可以通过setDaemon()函数来设定线程的daemon属性。当daemon属性设置为True的时候表明主线程的退出可以不用等待子线程完成。默认情况下，daemon标志为False,所有的非守护线程结束后主线程才会结束。</p><h3 id="使用Queue使多线程编程更安全"><a href="#使用Queue使多线程编程更安全" class="headerlink" title="使用Queue使多线程编程更安全"></a>使用Queue使多线程编程更安全</h3><h5 id="Queue模块提供了-3种队列"><a href="#Queue模块提供了-3种队列" class="headerlink" title="Queue模块提供了 3种队列"></a>Queue模块提供了 3种队列</h5><ul><li>Queue.Queue(maxsize):先进先出，maxsize为队列大小，其值为非正数的时候为无限循环队列。</li><li>Queue.LifoQueue(maxsize):后进先出，相当于栈。</li><li>Queue.PriorityQueue(maxsize):优先级队列。</li></ul><h5 id="队列支持以下方法"><a href="#队列支持以下方法" class="headerlink" title="队列支持以下方法"></a>队列支持以下方法</h5><ul><li>Queue.qsize():返回近似的队列大小</li><li>Queue.empty():列队为空的时候返回True，否则返回False。</li><li>Queue.full():当设定了队列大小的情况下，如果队列满则返回True,否则返回False。</li><li>Queue.put(item [,block[,timeout]]):往队列中添加元素item, block设置为False的时候,如果队列满则抛出Full异常.如果block设置为True,timeout为None的时候则会一直等待直到有空位置，否则会根据timeout的设定超时后拋出Full异常。</li><li>Queue.put_nowait(item):等价于put(item，False)</li><li>Queue.get([block[, timeout]]):从队列中删除元索并返回该元素的值。</li><li>Queue.get_nowait():等价于get(False)。</li><li>Queue.task_done():发送信号表明人列任务已经完成，经常在消费者线程中用到。</li><li>Queue.join():阻塞直至队列中所有的元素处理完毕。</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> Queue</div><div class="line"><span class="keyword">import</span> threading</div><div class="line"><span class="keyword">import</span> urllib2</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DownloadThread</span><span class="params">(threading.Thread)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, queue)</span>:</span></div><div class="line">        threading.Thread.__init__(self)</div><div class="line">        self.queue = queue</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">            url = self.queue.get()</div><div class="line">            <span class="keyword">print</span> self.name + <span class="string">"begin download"</span>+url+<span class="string">"..."</span></div><div class="line">            self.download_file(url)</div><div class="line">            self.queue.task_done()</div><div class="line">            <span class="keyword">print</span> self.name + <span class="string">"end download"</span>+url+<span class="string">"..."</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">download_file</span><span class="params">(self,url)</span>:</span></div><div class="line">        urlhandler = urllib2.urlopen(url)</div><div class="line">        fname = os.path.basename(url) + <span class="string">".html"</span></div><div class="line">        <span class="keyword">with</span> open (fname, <span class="string">"wb"</span>) <span class="keyword">as</span> f:</div><div class="line">            <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">                chunk = urlhandler.read(<span class="number">1024</span>)</div><div class="line">                <span class="keyword">if</span> <span class="keyword">not</span> chunk: <span class="keyword">break</span></div><div class="line">                f.write(chunk)</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    urls = [<span class="string">"http://wiki.python.org/moin/WebPrograrnming"</span>,</div><div class="line">            <span class="string">"https://www.createspace.com/3611970"</span>,</div><div class="line">            <span class="string">"http ://wiki .python.org/moin/Documentation"</span>]</div><div class="line">    queue = Queue.Queue()</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range (<span class="number">5</span>):</div><div class="line">        t = DownloadThread(queue)</div><div class="line">        t.setDaemon(<span class="keyword">True</span>)</div><div class="line">        t.start ()</div><div class="line"></div><div class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls:</div><div class="line">        queue.put(url)</div><div class="line"></div><div class="line">    queue.join()</div></pre></td></tr></table></figure></div><div></div><div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Python/" rel="tag">#Python</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2017/02/17/改善python程序-内部机制/" rel="next" title="改善python程序-内部机制"><i class="fa fa-chevron-left"></i> 改善python程序-内部机制</a></div><div class="post-nav-prev post-nav-item"><a href="/2017/02/18/Django入门/" rel="prev" title="Django入门">Django入门 <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Sambeau Wang"><p class="site-author-name" itemprop="name">Sambeau Wang</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">10</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories"><span class="site-state-item-count">5</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags"><span class="site-state-item-count">4</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/SambeauWang" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub </a></span><span class="links-of-author-item"><a href="sambeauwang@gmail.com" target="_blank" title="Gmail"><i class="fa fa-fw fa-gmail"></i> Gmail</a></span></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#掌握字符串的基本用法"><span class="nav-number">1.</span> <span class="nav-text">掌握字符串的基本用法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#性质判定"><span class="nav-number">1.0.1.</span> <span class="nav-text">性质判定</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#査找与替换"><span class="nav-number">1.0.2.</span> <span class="nav-text">査找与替换</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#字符串的分切与连接"><span class="nav-number">1.0.3.</span> <span class="nav-text">字符串的分切与连接</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#变形"><span class="nav-number">1.0.4.</span> <span class="nav-text">变形</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#删减与填充"><span class="nav-number">1.0.5.</span> <span class="nav-text">删减与填充</span></a></li></ol></li></ol><li class="nav-item nav-level-3"><a class="nav-link" href="#按需选择sort-或者sorted"><span class="nav-number">2.</span> <span class="nav-text">按需选择sort()或者sorted()</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#sorted-函数会返回一个排序后的列表-原有列表保持不变-而Sort-函数会直接修改原有列表"><span class="nav-number">2.0.1.</span> <span class="nav-text">sorted()函数会返回一个排序后的列表,原有列表保持不变;而Sort()函数会直接修改原有列表</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#对字典进行排序"><span class="nav-number">2.0.2.</span> <span class="nav-text">对字典进行排序</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#多维list排序"><span class="nav-number">2.0.3.</span> <span class="nav-text">多维list排序</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#字典中混合list排序"><span class="nav-number">2.0.4.</span> <span class="nav-text">字典中混合list排序</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#List中混合宇典排序"><span class="nav-number">2.0.5.</span> <span class="nav-text">List中混合宇典排序</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用copy模块深拷贝对象"><span class="nav-number">3.</span> <span class="nav-text">使用copy模块深拷贝对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用Counter进行计数统计"><span class="nav-number">4.</span> <span class="nav-text">使用Counter进行计数统计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#深入掌握ConfigParser"><span class="nav-number">5.</span> <span class="nav-text">深入掌握ConfigParser</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#配置项值的査找规则如下"><span class="nav-number">5.0.1.</span> <span class="nav-text">配置项值的査找规则如下</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ConfigParser支持类似Python中字符串格式化"><span class="nav-number">5.0.2.</span> <span class="nav-text">ConfigParser支持类似Python中字符串格式化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#getboolean-根据一定的规则将配置项的值转换为布尔值"><span class="nav-number">5.0.3.</span> <span class="nav-text">getboolean()根据一定的规则将配置项的值转换为布尔值</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用argparse处理命令行参数"><span class="nav-number">6.</span> <span class="nav-text">使用argparse处理命令行参数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#支持类型增多"><span class="nav-number">6.0.1.</span> <span class="nav-text">支持类型增多</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#支持参数分组"><span class="nav-number">6.0.2.</span> <span class="nav-text">支持参数分组</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#支持子命令"><span class="nav-number">6.0.3.</span> <span class="nav-text">支持子命令</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用pandas处理大型CSV文件-一种逗号分隔型值的纯文本格式文件"><span class="nav-number">7.</span> <span class="nav-text">使用pandas处理大型CSV文件(一种逗号分隔型值的纯文本格式文件)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#常见的API"><span class="nav-number">7.0.1.</span> <span class="nav-text">常见的API</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Pandas的使用"><span class="nav-number">7.0.2.</span> <span class="nav-text">Pandas的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Pandas中处理CSV文件的函数"><span class="nav-number">7.0.2.1.</span> <span class="nav-text">Pandas中处理CSV文件的函数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用ElementTree解析XML"><span class="nav-number">8.</span> <span class="nav-text">使用ElementTree解析XML</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ElementTree主要的方法和使用示例"><span class="nav-number">8.0.1.</span> <span class="nav-text">ElementTree主要的方法和使用示例</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Element主要的方法和使用示例"><span class="nav-number">8.0.2.</span> <span class="nav-text">Element主要的方法和使用示例</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#iteiparse的使用示例：统计userid在整个XML出现的次数"><span class="nav-number">8.0.3.</span> <span class="nav-text">iteiparse的使用示例：统计userid在整个XML出现的次数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#理解模块pickle优劣"><span class="nav-number">9.</span> <span class="nav-text">理解模块pickle优劣</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#序列化的另一个不错的选择——JSON"><span class="nav-number">10.</span> <span class="nav-text">序列化的另一个不错的选择——JSON</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#JSON文档的构成非常简单，仅存在以下两大数据结构"><span class="nav-number">10.0.1.</span> <span class="nav-text">JSON文档的构成非常简单，仅存在以下两大数据结构</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#json模块利用了编码（JSONEncoder-和解码类（JSONDecoder-拓展其他类型"><span class="nav-number">10.0.2.</span> <span class="nav-text">json模块利用了编码（JSONEncoder)和解码类（JSONDecoder)拓展其他类型</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用traceback获取栈信息"><span class="nav-number">11.</span> <span class="nav-text">使用traceback获取栈信息</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#常用的方法"><span class="nav-number">11.0.1.</span> <span class="nav-text">常用的方法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用logging记录日志信息"><span class="nav-number">12.</span> <span class="nav-text">使用logging记录日志信息</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#logging-lib包含以下4个主要对象"><span class="nav-number">12.0.1.</span> <span class="nav-text">logging lib包含以下4个主要对象</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#范例"><span class="nav-number">12.0.2.</span> <span class="nav-text">范例</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#控制运行输出到console"><span class="nav-number">12.0.3.</span> <span class="nav-text">控制运行输出到console</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用threading模块编写多线程程序-thread和-threading"><span class="nav-number">13.</span> <span class="nav-text">使用threading模块编写多线程程序(thread和 threading)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用Queue使多线程编程更安全"><span class="nav-number">14.</span> <span class="nav-text">使用Queue使多线程编程更安全</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Queue模块提供了-3种队列"><span class="nav-number">14.0.1.</span> <span class="nav-text">Queue模块提供了 3种队列</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#队列支持以下方法"><span class="nav-number">14.0.2.</span> <span class="nav-text">队列支持以下方法</span></a></li></ol></li></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2017</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Sambeau Wang</span></div><div class="powered-by"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>本站总访问量 <span id="busuanzi_value_site_pv"></span> &nbsp&nbsp&nbsp 您是第<span id="busuanzi_value_site_uv"></span>个来到的小伙伴</div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.0.2"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script><script type="text/javascript">function run_disqus_script(s){var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src="//"+disqus_shortname+".disqus.com/"+s,(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(i)}var disqus_shortname="sambeaublog.disqus.com/admin",disqus_identifier="2017/02/17/改善python程序-库/",disqus_title="改善python程序-库",disqus_url="http://yoursite.com/2017/02/17/改善python程序-库/";run_disqus_script("count.js");var disqus_config=function(){this.page.url=disqus_url,this.page.identifier=disqus_identifier,this.page.title=disqus_title};run_disqus_script("embed.js")</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("MmTla9uHtyvAotAPz2aHArnn-gzGzoHsz","ppTjU9IN1rosOHlnsYjpxXJe")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){var t=".leancloud-visitors-count";if(0===e.length)return void o.find(t).text(0);for(var i=0;i<e.length;i++){var r=e[i],s=r.get("url"),l=r.get("time"),c=document.getElementById(s);$(c).find(t).text(l)}for(var i=0;i<n.length;i++){var s=n[i],c=document.getElementById(s),u=$(c).find(t);""==u.text()&&u.text(0)}}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var r=new e,s=new AV.ACL;s.setPublicReadAccess(!0),s.setPublicWriteAccess(!0),r.setACL(s),r.set("title",o),r.set("url",n),r.set("time",1),r.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script></body></html>